<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Triage P√©diatrique - Aide √† l'orientation</title>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
            color: #333;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
        }
        .disclaimer {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 0.9em;
        }
        .category {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .category h2 {
            margin-top: 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
            font-size: 1.2em;
        }
        .symptom-item {
            margin: 10px 0;
        }
        .symptom-item > label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-weight: 500;
        }
        .symptom-item > label input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 10px;
        }
        .sub-options {
            display: none;
            margin-left: 35px;
            margin-top: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
            border-left: 3px solid #007bff;
        }
        .sub-options.visible {
            display: block;
        }
        .sub-options label {
            display: block;
            margin: 5px 0;
            cursor: pointer;
        }
        .sub-options input[type="radio"],
        .sub-options input[type="checkbox"] {
            margin-right: 8px;
        }
        .red-flag {
            color: #dc3545;
        }
        .red-flag::after {
            content: " ‚ö†Ô∏è";
        }
        
        /* Mode switch */
        .mode-switch {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            gap: 0;
        }
        .mode-switch button {
            padding: 12px 30px;
            font-size: 1em;
            border: 2px solid #007bff;
            background: white;
            color: #007bff;
            cursor: pointer;
            transition: all 0.2s;
        }
        .mode-switch button:first-child {
            border-radius: 8px 0 0 8px;
        }
        .mode-switch button:last-child {
            border-radius: 0 8px 8px 0;
            border-left: none;
        }
        .mode-switch button.active {
            background: #007bff;
            color: white;
        }
        .mode-switch button:hover:not(.active) {
            background: #e7f1ff;
        }
        
        /* Mode containers */
        #mode-triage, #mode-reverse {
            display: none;
        }
        #mode-triage.active, #mode-reverse.active {
            display: block;
        }
        
        /* Reverse mode styles */
        .maladie-select {
            width: 100%;
            padding: 12px;
            font-size: 1.1em;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin-bottom: 20px;
            background: white;
        }
        .maladie-detail {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .maladie-detail h3 {
            margin-top: 0;
            color: #2c3e50;
            font-size: 1.4em;
        }
        .maladie-section {
            margin: 15px 0;
            padding: 15px;
            border-radius: 8px;
        }
        .maladie-section h4 {
            margin: 0 0 10px 0;
            font-size: 1em;
        }
        .maladie-section ul {
            margin: 0;
            padding-left: 20px;
        }
        .maladie-section li {
            margin: 5px 0;
        }
        .section-symptomes {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
        }
        .section-absents {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
        }
        .section-alertes {
            background: #ffebee;
            border-left: 4px solid #f44336;
        }
        .section-conseils {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
        }
        .section-niveau {
            display: inline-block;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        .niveau-vert { background: #d4edda; color: #155724; }
        .niveau-jaune { background: #fff3cd; color: #856404; }
        .niveau-orange { background: #ffe5d0; color: #8a4500; }
        .niveau-rouge { background: #f8d7da; color: #721c24; }
        
        .red-flag::after {
            content: " ‚ö†Ô∏è";
        }
        button#analyser {
            display: block;
            width: 100%;
            padding: 15px 30px;
            font-size: 1.2em;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin: 20px 0;
        }
        button#analyser:hover {
            background: #0056b3;
        }
        button#reset {
            display: block;
            width: 100%;
            padding: 10px;
            font-size: 1em;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }
        #resultat {
            display: none;
            padding: 25px;
            border-radius: 10px;
            margin-top: 20px;
        }
        #resultat.niveau-rouge {
            background: #f8d7da;
            border: 2px solid #dc3545;
        }
        #resultat.niveau-orange {
            background: #ffe5d0;
            border: 2px solid #fd7e14;
        }
        #resultat.niveau-jaune {
            background: #fff3cd;
            border: 2px solid #ffc107;
        }
        #resultat.niveau-vert {
            background: #d4edda;
            border: 2px solid #28a745;
        }
        #resultat h3 {
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .urgence-icon {
            font-size: 2em;
        }
        .pathologies-probables {
            margin-top: 15px;
            padding: 15px;
            background: rgba(255,255,255,0.7);
            border-radius: 8px;
        }
        .pathologies-probables h4 {
            margin-top: 0;
        }
        .pathologie-item {
            padding: 8px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }
        .pathologie-item:last-child {
            border-bottom: none;
        }
        .conseils {
            margin-top: 15px;
            padding: 15px;
            background: rgba(255,255,255,0.7);
            border-radius: 8px;
        }
        .conseils h4 {
            margin-top: 0;
        }
        .conseils ul {
            margin: 0;
            padding-left: 20px;
        }
        .surveillance {
            margin-top: 15px;
            padding: 15px;
            background: rgba(0,0,0,0.05);
            border-radius: 8px;
        }
        .surveillance h4 {
            margin-top: 0;
            color: #856404;
        }
        .psy-alert {
            margin-top: 15px;
            padding: 15px;
            background: #e2e3f3;
            border-radius: 8px;
            border-left: 4px solid #6f42c1;
        }
    </style>
</head>
<body>
    <h1>ü©∫ Triage P√©diatrique (6-15 ans)</h1>
    
    <div class="mode-switch">
        <button id="btn-triage" class="active" onclick="switchMode('triage')">üîç Triage</button>
        <button id="btn-reverse" onclick="switchMode('reverse')">üìö R√©f√©rentiel maladies</button>
    </div>
    
    <div class="disclaimer">
        <strong>‚ö†Ô∏è Cet outil ne remplace pas un avis m√©dical.</strong><br>
        Il aide √† √©valuer l'urgence d'une consultation. En cas de doute, consultez toujours un professionnel de sant√©.
        En cas d'urgence vitale, appelez le <strong>15</strong> ou le <strong>112</strong>.
    </div>

    <!-- MODE TRIAGE -->
    <div id="mode-triage" class="active">

    <!-- G√âN√âRAL -->
    <div class="category">
        <h2>üå°Ô∏è √âtat g√©n√©ral</h2>
        
        <div class="symptom-item">
            <label><input type="checkbox" id="fievre" onchange="toggleSub(this)"> Fi√®vre</label>
            <div class="sub-options" id="sub-fievre">
                <strong>Temp√©rature :</strong><br>
                <label><input type="radio" name="temp" value="38"> 38 - 38.5¬∞C (l√©g√®re)</label>
                <label><input type="radio" name="temp" value="38.5"> 38.5 - 39¬∞C (mod√©r√©e)</label>
                <label><input type="radio" name="temp" value="39"> 39 - 40¬∞C (√©lev√©e)</label>
                <label class="red-flag"><input type="radio" name="temp" value="40"> &gt; 40¬∞C</label>
            </div>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="fatigue" onchange="toggleSub(this)"> Fatigue inhabituelle</label>
            <div class="sub-options" id="sub-fatigue">
                <label><input type="radio" name="fatigue-level" value="legere"> L√©g√®re - moins actif que d'habitude</label>
                <label><input type="radio" name="fatigue-level" value="marquee"> Marqu√©e - reste couch√©, peu d'int√©r√™t</label>
                <label class="red-flag"><input type="radio" name="fatigue-level" value="prostration"> Prostration - ne r√©agit presque plus</label>
            </div>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="appetit"> Perte d'app√©tit</label>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="frissons"> Frissons / Sueurs</label>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="courbatures"> Courbatures / Douleurs musculaires intenses</label>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="douleur-yeux"> Douleur derri√®re les yeux (r√©tro-orbitaire)</label>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="paleur" onchange="toggleSub(this)"> P√¢leur / Teint anormal</label>
            <div class="sub-options" id="sub-paleur">
                <label><input type="radio" name="paleur-type" value="pale"> P√¢le</label>
                <label><input type="radio" name="paleur-type" value="gris"> Teint gris / terreux</label>
                <label class="red-flag"><input type="radio" name="paleur-type" value="marbrures"> Marbrures (taches violac√©es)</label>
            </div>
        </div>
    </div>

    <!-- CONSTANTES VITALES -->
    <div class="category" style="border-left: 4px solid #17a2b8;">
        <h2>üìä Constantes vitales (si disponibles)</h2>
        <p style="font-size: 0.9em; color: #666;">Facultatif - remplir si vous avez le mat√©riel</p>
        
        <div class="symptom-item">
            <label><input type="checkbox" id="has-spo2" onchange="toggleSub(this)"> J'ai mesur√© la saturation (SpO2)</label>
            <div class="sub-options" id="sub-has-spo2">
                <strong>Valeur affich√©e :</strong><br>
                <label><input type="radio" name="spo2-val" value="95"> ‚â• 95% (normale)</label>
                <label><input type="radio" name="spo2-val" value="92"> 92 - 94%</label>
                <label class="red-flag"><input type="radio" name="spo2-val" value="90"> < 92%</label>
            </div>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="has-fc" onchange="toggleSub(this)"> J'ai mesur√© la fr√©quence cardiaque (FC)</label>
            <div class="sub-options" id="sub-has-fc">
                <strong>√Çge de l'enfant :</strong><br>
                <label><input type="radio" name="fc-age" value="6-8"> 6-8 ans</label>
                <label><input type="radio" name="fc-age" value="9-12"> 9-12 ans</label>
                <label><input type="radio" name="fc-age" value="13-15"> 13-15 ans</label>
                <hr>
                <strong>FC mesur√©e (bpm) :</strong><br>
                <input type="number" id="fc-value" min="40" max="220" placeholder="ex: 95" style="width: 100px; padding: 5px;">
            </div>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="has-temp-mode" onchange="toggleSub(this)"> Pr√©ciser le mode de prise de temp√©rature</label>
            <div class="sub-options" id="sub-has-temp-mode">
                <label><input type="radio" name="temp-mode" value="rectale"> Rectale (r√©f√©rence)</label>
                <label><input type="radio" name="temp-mode" value="buccale"> Buccale (bouche)</label>
                <label><input type="radio" name="temp-mode" value="oreille"> Oreille (tympanique)</label>
                <label><input type="radio" name="temp-mode" value="front"> Front (infrarouge / gun)</label>
                <label><input type="radio" name="temp-mode" value="aisselle"> Aisselle (axillaire)</label>
            </div>
        </div>
    </div>

    <!-- RESPIRATOIRE -->
    <div class="category">
        <h2>ü´Å Respiratoire</h2>
        
        <div class="symptom-item">
            <label><input type="checkbox" id="toux" onchange="toggleSub(this)"> Toux</label>
            <div class="sub-options" id="sub-toux">
                <label><input type="radio" name="toux-type" value="seche"> S√®che</label>
                <label><input type="radio" name="toux-type" value="grasse"> Grasse (productive)</label>
                <label><input type="radio" name="toux-type" value="aboyante"> Aboyante (comme un chien)</label>
                <label><input type="radio" name="toux-type" value="quinteuse"> Quinteuse (s√©ries prolong√©es)</label>
            </div>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="nez" onchange="toggleSub(this)"> Nez qui coule</label>
            <div class="sub-options" id="sub-nez">
                <label><input type="radio" name="nez-type" value="clair"> Clair / transparent</label>
                <label><input type="radio" name="nez-type" value="jaune"> Jaune / vert (√©pais)</label>
                <label><input type="radio" name="nez-type" value="sang"> Avec du sang</label>
            </div>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="gorge" onchange="toggleSub(this)"> Mal de gorge</label>
            <div class="sub-options" id="sub-gorge">
                <label><input type="radio" name="gorge-type" value="douleur"> Douleur simple</label>
                <label><input type="radio" name="gorge-type" value="avaler"> Difficult√© √† avaler</label>
                <label class="red-flag"><input type="radio" name="gorge-type" value="bave"> Ne d√©glutit plus / bave</label>
            </div>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="respiration" onchange="toggleSub(this)"> Difficult√©s respiratoires</label>
            <div class="sub-options" id="sub-respiration">
                <label><input type="radio" name="respi-type" value="rapide"> Respiration rapide</label>
                <label><input type="radio" name="respi-type" value="sifflante"> Sifflements</label>
                <label class="red-flag"><input type="radio" name="respi-type" value="tirage"> Tirage (creuse entre les c√¥tes)</label>
                <label class="red-flag"><input type="radio" name="respi-type" value="cyanose"> L√®vres / ongles bleut√©s</label>
            </div>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="voix" onchange="toggleSub(this)"> Voix modifi√©e</label>
            <div class="sub-options" id="sub-voix">
                <label><input type="radio" name="voix-type" value="enrouee"> Enrou√©e</label>
                <label><input type="radio" name="voix-type" value="eteinte"> √âteinte</label>
            </div>
        </div>
    </div>

    <!-- DIGESTIF -->
    <div class="category">
        <h2>ü§¢ Digestif</h2>
        
        <div class="symptom-item">
            <label><input type="checkbox" id="vomissements" onchange="toggleSub(this)"> Vomissements</label>
            <div class="sub-options" id="sub-vomissements">
                <strong>Aspect :</strong><br>
                <label><input type="radio" name="vomi-type" value="alimentaire"> Alimentaires</label>
                <label><input type="radio" name="vomi-type" value="glaires"> Glaires / mousseux</label>
                <label><input type="radio" name="vomi-type" value="bilieux"> Bilieux (verd√¢tre)</label>
                <label class="red-flag"><input type="radio" name="vomi-type" value="sang"> Sang rouge</label>
                <label class="red-flag"><input type="radio" name="vomi-type" value="marc"> Marc de caf√© (noir√¢tre)</label>
                <hr>
                <strong>Fr√©quence :</strong><br>
                <label><input type="radio" name="vomi-freq" value="isole"> Isol√© (1-2 fois)</label>
                <label><input type="radio" name="vomi-freq" value="repete"> R√©p√©t√©s</label>
                <label><input type="radio" name="vomi-freq" value="incoercible"> Incoercibles (ne garde rien)</label>
            </div>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="diarrhee" onchange="toggleSub(this)"> Diarrh√©e</label>
            <div class="sub-options" id="sub-diarrhee">
                <strong>Consistance :</strong><br>
                <label><input type="radio" name="diarrhee-type" value="molle"> Molle</label>
                <label><input type="radio" name="diarrhee-type" value="liquide"> Liquide</label>
                <label><input type="radio" name="diarrhee-type" value="explosive"> Explosive / tr√®s fr√©quente</label>
                <hr>
                <strong>Couleur :</strong><br>
                <label><input type="radio" name="diarrhee-couleur" value="normale"> Normale / brun√¢tre</label>
                <label><input type="radio" name="diarrhee-couleur" value="pale"> P√¢le / d√©color√©e</label>
                <label class="red-flag"><input type="radio" name="diarrhee-couleur" value="sang"> Sang rouge</label>
                <label class="red-flag"><input type="radio" name="diarrhee-couleur" value="noire"> Noire (m√©l√©na)</label>
            </div>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="douleur-abdo" onchange="toggleSub(this)"> Douleur abdominale</label>
            <div class="sub-options" id="sub-douleur-abdo">
                <strong>Localisation actuelle :</strong><br>
                <label><input type="radio" name="abdo-loc" value="diffuse"> Diffuse (partout)</label>
                <label><input type="radio" name="abdo-loc" value="estomac"> Estomac (haut)</label>
                <label><input type="radio" name="abdo-loc" value="nombril"> Autour du nombril</label>
                <label><input type="radio" name="abdo-loc" value="fid"> En bas √† droite</label>
                <label><input type="radio" name="abdo-loc" value="fig"> En bas √† gauche</label>
                <hr>
                <strong>√âvolution / Caract√©ristiques :</strong><br>
                <label><input type="checkbox" name="abdo-carac" value="constante"> Constante</label>
                <label><input type="checkbox" name="abdo-carac" value="crampes"> Par crampes</label>
                <label><input type="checkbox" name="abdo-carac" value="migration"> A commenc√© autour du nombril puis s'est d√©plac√©e</label>
                <label><input type="checkbox" name="abdo-carac" value="augmente"> Augmente progressivement</label>
                <label class="red-flag"><input type="checkbox" name="abdo-carac" value="defense"> Ventre dur / ne se laisse pas toucher</label>
                <hr>
                <strong>Signes associ√©s (appendicite) :</strong><br>
                <label><input type="checkbox" name="abdo-append" value="vomi-apres"> Vomissements apparus APR√àS la douleur</label>
                <label><input type="checkbox" name="abdo-append" value="anorexie"> Refuse vraiment de manger</label>
                <label><input type="checkbox" name="abdo-append" value="marche"> Marche courb√© / refuse de sauter</label>
                <label><input type="checkbox" name="abdo-append" value="couche"> Reste couch√© en chien de fusil</label>
            </div>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="constipation"> Constipation (pas de selles &gt; 3 jours)</label>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="deshydratation" onchange="toggleSub(this)"> Signes de d√©shydratation</label>
            <div class="sub-options" id="sub-deshydratation">
                <label><input type="checkbox" name="desh" value="soif"> Soif importante</label>
                <label><input type="checkbox" name="desh" value="bouche"> Bouche s√®che</label>
                <label><input type="checkbox" name="desh" value="urines"> Urines rares / fonc√©es</label>
                <label class="red-flag"><input type="checkbox" name="desh" value="pli"> Pli cutan√© persistant</label>
                <label class="red-flag"><input type="checkbox" name="desh" value="yeux"> Yeux creux / cern√©s</label>
                <label class="red-flag"><input type="checkbox" name="desh" value="pasurines"> Pas d'urines depuis &gt; 8h</label>
            </div>
        </div>
    </div>

    <!-- CUTAN√â -->
    <div class="category">
        <h2>üî¥ Cutan√© (peau)</h2>
        
        <div class="symptom-item">
            <label><input type="checkbox" id="eruption" onchange="toggleSub(this)"> √âruption / Boutons</label>
            <div class="sub-options" id="sub-eruption">
                <strong>Type :</strong><br>
                <label><input type="radio" name="eruption-type" value="boutons"> Boutons rouges</label>
                <label><input type="radio" name="eruption-type" value="plaques"> Plaques rouges</label>
                <label><input type="radio" name="eruption-type" value="vesicules"> V√©sicules (petites cloques)</label>
                <label><input type="radio" name="eruption-type" value="urticaire"> Urticaire (relief, d√©mangeaisons)</label>
                <label class="red-flag"><input type="radio" name="eruption-type" value="purpura"> Taches rouge/violet qui NE S'EFFACENT PAS √† la pression</label>
                <hr>
                <strong>Localisation :</strong><br>
                <label><input type="checkbox" name="eruption-loc" value="visage"> Visage</label>
                <label><input type="checkbox" name="eruption-loc" value="tronc"> Tronc</label>
                <label><input type="checkbox" name="eruption-loc" value="membres"> Membres</label>
                <label><input type="checkbox" name="eruption-loc" value="mains"> Paumes des mains</label>
                <label><input type="checkbox" name="eruption-loc" value="pieds"> Plantes des pieds</label>
                <label><input type="checkbox" name="eruption-loc" value="fesses"> Fesses / si√®ge</label>
                <hr>
                <label><input type="checkbox" id="eruption-gratte"> √áa gratte</label>
            </div>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="aphtes"> Aphtes / l√©sions dans la bouche</label>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="oedeme" onchange="toggleSub(this)"> Gonflement (≈ìd√®me)</label>
            <div class="sub-options" id="sub-oedeme">
                <label><input type="radio" name="oedeme-loc" value="visage"> Visage</label>
                <label><input type="radio" name="oedeme-loc" value="levres"> L√®vres / langue</label>
                <label><input type="radio" name="oedeme-loc" value="membres"> Membres</label>
                <label><input type="radio" name="oedeme-loc" value="oeil"> ≈íil / paupi√®re</label>
            </div>
        </div>

        <div class="symptom-item">
            <label class="red-flag"><input type="checkbox" id="ictere"> Jaunisse (yeux/peau jaunes)</label>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="saignements" onchange="toggleSub(this)" class="red-flag"> Saignements spontan√©s</label>
            <div class="sub-options" id="sub-saignements">
                <label><input type="checkbox" name="saign" value="gencives"> Gencives qui saignent</label>
                <label><input type="checkbox" name="saign" value="nez"> Saignements de nez r√©p√©t√©s</label>
                <label><input type="checkbox" name="saign" value="ecchymoses"> Ecchymoses (bleus) spontan√©es</label>
                <label><input type="checkbox" name="saign" value="petechies"> Petits points rouges (p√©t√©chies)</label>
            </div>
        </div>

        <div class="symptom-item">
            <label class="red-flag"><input type="checkbox" id="extremites-froides"> Extr√©mit√©s froides / moites</label>
        </div>
    </div>

    <!-- NEUROLOGIQUE -->
    <div class="category">
        <h2>üß† Neurologique</h2>
        
        <div class="symptom-item">
            <label><input type="checkbox" id="cephalee" onchange="toggleSub(this)"> Mal de t√™te</label>
            <div class="sub-options" id="sub-cephalee">
                <label><input type="radio" name="cephalee-type" value="leger"> L√©ger</label>
                <label><input type="radio" name="cephalee-type" value="modere"> Mod√©r√©</label>
                <label><input type="radio" name="cephalee-type" value="intense"> Intense</label>
                <label class="red-flag"><input type="radio" name="cephalee-type" value="brutal"> Brutal et tr√®s intense ("pire de sa vie")</label>
            </div>
        </div>

        <div class="symptom-item">
            <label class="red-flag"><input type="checkbox" id="raideur-nuque"> Raideur de nuque (ne peut pas toucher poitrine avec menton)</label>
        </div>

        <div class="symptom-item">
            <label class="red-flag"><input type="checkbox" id="convulsions"> Convulsions</label>
        </div>

        <div class="symptom-item">
            <label class="red-flag"><input type="checkbox" id="confusion"> Confusion / Comportement anormal / Somnolence excessive</label>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="vertiges"> Vertiges</label>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="photophobie"> G√™n√© par la lumi√®re (photophobie)</label>
        </div>
    </div>

    <!-- ORL -->
    <div class="category">
        <h2>üëÇ ORL / T√™te</h2>
        
        <div class="symptom-item">
            <label><input type="checkbox" id="oreille" onchange="toggleSub(this)"> Douleur d'oreille</label>
            <div class="sub-options" id="sub-oreille">
                <label><input type="radio" name="oreille-cote" value="uni"> Une oreille</label>
                <label><input type="radio" name="oreille-cote" value="bi"> Les deux oreilles</label>
                <hr>
                <label><input type="checkbox" name="oreille-ecoul" value="oui"> √âcoulement (liquide qui sort)</label>
            </div>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="ganglions" onchange="toggleSub(this)"> Ganglions palpables</label>
            <div class="sub-options" id="sub-ganglions">
                <label><input type="radio" name="ganglions-loc" value="cou"> Cou</label>
                <label><input type="radio" name="ganglions-loc" value="multiple"> Plusieurs zones</label>
            </div>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="yeux" onchange="toggleSub(this)"> Probl√®me aux yeux</label>
            <div class="sub-options" id="sub-yeux">
                <label><input type="checkbox" name="yeux-type" value="rouge"> Rouges</label>
                <label><input type="checkbox" name="yeux-type" value="colles"> Coll√©s / s√©cr√©tions</label>
                <label><input type="checkbox" name="yeux-type" value="larmoie"> Larmoiement</label>
            </div>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="anosmie"> Perte d'odorat et/ou de go√ªt</label>
        </div>
    </div>

    <!-- URINAIRE -->
    <div class="category">
        <h2>üíß Urinaire</h2>
        
        <div class="symptom-item">
            <label><input type="checkbox" id="urinaire" onchange="toggleSub(this)"> Probl√®mes urinaires</label>
            <div class="sub-options" id="sub-urinaire">
                <label><input type="checkbox" name="uri" value="brulure"> Br√ªlures en urinant</label>
                <label><input type="checkbox" name="uri" value="frequent"> Envies fr√©quentes</label>
                <label><input type="checkbox" name="uri" value="trouble"> Urines troubles</label>
                <label><input type="checkbox" name="uri" value="odeur"> Urines malodorantes</label>
                <label class="red-flag"><input type="checkbox" name="uri" value="sang"> Sang dans les urines</label>
            </div>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="douleur-lombaire"> Douleur dans le dos (lombaire)</label>
        </div>
    </div>

    <!-- OST√âO -->
    <div class="category">
        <h2>ü¶¥ Ost√©o-articulaire</h2>
        
        <div class="symptom-item">
            <label><input type="checkbox" id="douleur-articulaire" onchange="toggleSub(this)"> Douleurs articulaires</label>
            <div class="sub-options" id="sub-douleur-articulaire">
                <strong>Intensit√© :</strong><br>
                <label><input type="radio" name="artic-intensite" value="legere"> L√©g√®res</label>
                <label><input type="radio" name="artic-intensite" value="moderee"> Mod√©r√©es</label>
                <label><input type="radio" name="artic-intensite" value="intense"> Intenses / invalidantes</label>
                <hr>
                <strong>Localisation :</strong><br>
                <label><input type="checkbox" name="artic-loc" value="petites"> Petites articulations (doigts, poignets, chevilles)</label>
                <label><input type="checkbox" name="artic-loc" value="grosses"> Grosses articulations (genoux, coudes)</label>
                <label><input type="checkbox" name="artic-loc" value="multiples"> Plusieurs articulations touch√©es</label>
            </div>
        </div>

        <div class="symptom-item">
            <label><input type="checkbox" id="douleur-membre" onchange="toggleSub(this)"> Douleur membre</label>
            <div class="sub-options" id="sub-douleur-membre">
                <label><input type="radio" name="membre-type" value="effort"> Apr√®s effort / sport</label>
                <label><input type="radio" name="membre-type" value="spontanee"> Spontan√©e</label>
                <label><input type="checkbox" name="membre-signe" value="boiterie"> Boiterie</label>
                <label><input type="checkbox" name="membre-signe" value="gonfle"> Articulation gonfl√©e</label>
                <label><input type="checkbox" name="membre-signe" value="rouge"> Articulation rouge / chaude</label>
            </div>
        </div>
    </div>

    <!-- CONTEXTE ALIMENTAIRE / HYGI√àNE -->
    <div class="category" style="border-left: 4px solid #fd7e14;">
        <h2>üçΩÔ∏è Contexte alimentaire / hygi√®ne</h2>
        
        <div class="symptom-item">
            <label><input type="checkbox" id="repas-suspect"> Repas suspect dans les derni√®res 48h (viande/≈ìuf mal cuit, resto douteux, aliment p√©rim√©)</label>
        </div>
        <div class="symptom-item">
            <label><input type="checkbox" id="conserve-maison"> Consommation de conserves maison ou artisanales</label>
        </div>
        <div class="symptom-item">
            <label><input type="checkbox" id="collectivite"> Cas similaires dans l'entourage (√©cole, cantine, famille)</label>
        </div>
        <div class="symptom-item">
            <label><input type="checkbox" id="hygiene-mains"> Contact r√©cent avec enfants malades / hygi√®ne des mains douteuse</label>
        </div>
        <div class="symptom-item">
            <label><input type="checkbox" id="baignade"> Baignade r√©cente (rivi√®re, mare, eau stagnante)</label>
        </div>
    </div>

    <!-- SIGNES NEUROMUSCULAIRES (botulisme) -->
    <div class="category">
        <h2>üí™ Signes neuromusculaires</h2>
        
        <div class="symptom-item">
            <label><input type="checkbox" id="vision-trouble"> Vision trouble / double (diplopie)</label>
        </div>
        <div class="symptom-item">
            <label><input type="checkbox" id="paupieres-tombantes"> Paupi√®res tombantes</label>
        </div>
        <div class="symptom-item">
            <label class="red-flag"><input type="checkbox" id="faiblesse-musculaire"> Faiblesse musculaire progressive</label>
        </div>
        <div class="symptom-item">
            <label class="red-flag"><input type="checkbox" id="difficulte-parler"> Difficult√© √† parler / voix faible</label>
        </div>
        <div class="symptom-item">
            <label class="red-flag"><input type="checkbox" id="difficulte-respirer-muscles"> Difficult√© √† respirer par faiblesse (pas de sifflement)</label>
        </div>
    </div>

    <!-- CONTEXTE PSY -->
    <div class="category" style="border-left: 4px solid #6f42c1;">
        <h2>üí≠ Contexte √©motionnel / comportemental</h2>
        <p style="font-size: 0.9em; color: #666;">Ces √©l√©ments aident √† identifier un √©ventuel facteur stress/anxi√©t√©</p>
        
        <div class="symptom-item">
            <label><input type="checkbox" id="psy-ecole"> Sympt√¥mes surtout avant √©cole / contr√¥le / examen</label>
        </div>
        <div class="symptom-item">
            <label><input type="checkbox" id="psy-weekend"> Am√©lioration nette le week-end / vacances</label>
        </div>
        <div class="symptom-item">
            <label><input type="checkbox" id="psy-recurrent"> Plaintes r√©currentes sans cause m√©dicale trouv√©e</label>
        </div>
        <div class="symptom-item">
            <label><input type="checkbox" id="psy-event"> √âv√©nement stressant r√©cent (d√©m√©nagement, s√©paration, deuil, conflit...)</label>
        </div>
        <div class="symptom-item">
            <label><input type="checkbox" id="psy-sommeil"> Troubles du sommeil r√©cents</label>
        </div>
        <div class="symptom-item">
            <label><input type="checkbox" id="psy-humeur"> Changement d'humeur marqu√©</label>
        </div>
        <div class="symptom-item">
            <label><input type="checkbox" id="psy-verbalise"> Exprime de l'anxi√©t√© / tristesse / peur</label>
        </div>
    </div>

    <button id="analyser" onclick="analyser()">   üîç Analyser les sympt√¥mes</button>
    <button id="reset" onclick="resetForm()">      ‚Ü∫ R√©initialiser</button>

    <div id="resultat"></div>
    
    </div><!-- Fin mode-triage -->

    <!-- MODE REVERSE -->
    <div id="mode-reverse">
        <div class="category">
            <h2>üìö Choisissez une pathologie</h2>
            <select class="maladie-select" id="maladie-select" onchange="afficherMaladie()">
                <option value="">-- S√©lectionner une maladie --</option>
                <optgroup label="ORL / Respiratoire">
                    <option value="rhinopharyngite">Rhinopharyngite (rhume)</option>
                    <option value="angine">Angine</option>
                    <option value="otite">Otite moyenne aigu√´</option>
                    <option value="laryngite">Laryngite</option>
                    <option value="bronchite">Bronchite</option>
                    <option value="pneumonie">Pneumonie</option>
                    <option value="grippe">Grippe</option>
                    <option value="covid">COVID-19</option>
                </optgroup>
                <optgroup label="Digestif">
                    <option value="gastro">Gastro-ent√©rite</option>
                    <option value="tiac">Toxi-infection alimentaire (TIAC)</option>
                    <option value="appendicite">Appendicite</option>
                    <option value="occlusion">Occlusion intestinale</option>
                    <option value="hepatite">H√©patite virale</option>
                </optgroup>
                <optgroup label="Cutan√©">
                    <option value="varicelle">Varicelle</option>
                    <option value="pmb">Syndrome pieds-mains-bouche</option>
                    <option value="urticaire">Urticaire / Allergie</option>
                </optgroup>
                <optgroup label="Arboviroses (tropical)">
                    <option value="dengue">Dengue</option>
                    <option value="chikungunya">Chikungunya</option>
                    <option value="leptospirose">Leptospirose</option>
                </optgroup>
                <optgroup label="Autres infections">
                    <option value="mononucleose">Mononucl√©ose infectieuse</option>
                    <option value="cystite">Cystite (infection urinaire basse)</option>
                    <option value="pyelonephrite">Py√©lon√©phrite</option>
                    <option value="herpangine">Herpangine</option>
                    <option value="conjonctivite">Conjonctivite</option>
                </optgroup>
                <optgroup label="Urgences / Drapeaux rouges">
                    <option value="meningite">M√©ningite</option>
                    <option value="botulisme">Botulisme</option>
                    <option value="arthrite_septique">Arthrite septique</option>
                    <option value="anaphylaxie">R√©action anaphylactique</option>
                </optgroup>
            </select>
        </div>
        
        <div id="maladie-detail"></div>
    </div><!-- Fin mode-reverse -->

    <script>
        function toggleSub(checkbox) {
            const subId = 'sub-' + checkbox.id;
            const subDiv = document.getElementById(subId);
            if (subDiv) {
                subDiv.classList.toggle('visible', checkbox.checked);
            }
        }

        function getVal(name) {
            const el = document.querySelector(`input[name="${name}"]:checked`);
            return el ? el.value : null;
        }

        function isChecked(id) {
            const el = document.getElementById(id);
            return el ? el.checked : false;
        }

        function getCheckedValues(name) {
            const els = document.querySelectorAll(`input[name="${name}"]:checked`);
            return Array.from(els).map(e => e.value);
        }

        function analyser() {
            // Donn√©es collect√©es
            const data = {
                fievre: isChecked('fievre'),
                temp: getVal('temp'),
                fatigue: isChecked('fatigue'),
                fatigueLevel: getVal('fatigue-level'),
                appetit: isChecked('appetit'),
                frissons: isChecked('frissons'),
                courbatures: isChecked('courbatures'),
                douleurYeux: isChecked('douleur-yeux'),
                paleur: isChecked('paleur'),
                paleurType: getVal('paleur-type'),
                
                // Constantes vitales
                hasSpo2: isChecked('has-spo2'),
                spo2Val: getVal('spo2-val'),
                hasFc: isChecked('has-fc'),
                fcAge: getVal('fc-age'),
                fcValue: document.getElementById('fc-value')?.value || null,
                hasTempMode: isChecked('has-temp-mode'),
                tempMode: getVal('temp-mode'),
                
                toux: isChecked('toux'),
                touxType: getVal('toux-type'),
                nez: isChecked('nez'),
                nezType: getVal('nez-type'),
                gorge: isChecked('gorge'),
                gorgeType: getVal('gorge-type'),
                respiration: isChecked('respiration'),
                respiType: getVal('respi-type'),
                voix: isChecked('voix'),
                voixType: getVal('voix-type'),
                
                vomissements: isChecked('vomissements'),
                vomiType: getVal('vomi-type'),
                vomiFreq: getVal('vomi-freq'),
                diarrhee: isChecked('diarrhee'),
                diarrheeType: getVal('diarrhee-type'),
                diarrheeCouleur: getVal('diarrhee-couleur'),
                douleurAbdo: isChecked('douleur-abdo'),
                abdoLoc: getVal('abdo-loc'),
                abdoCarac: getCheckedValues('abdo-carac'),
                abdoAppend: getCheckedValues('abdo-append'),
                constipation: isChecked('constipation'),
                deshydratation: isChecked('deshydratation'),
                deshSignes: getCheckedValues('desh'),
                
                eruption: isChecked('eruption'),
                eruptionType: getVal('eruption-type'),
                eruptionLoc: getCheckedValues('eruption-loc'),
                eruptionGratte: isChecked('eruption-gratte'),
                aphtes: isChecked('aphtes'),
                oedeme: isChecked('oedeme'),
                oedemeLoc: getVal('oedeme-loc'),
                ictere: isChecked('ictere'),
                saignements: isChecked('saignements'),
                saignSignes: getCheckedValues('saign'),
                extremitesFroides: isChecked('extremites-froides'),
                
                cephalee: isChecked('cephalee'),
                cephaleeType: getVal('cephalee-type'),
                raideurNuque: isChecked('raideur-nuque'),
                convulsions: isChecked('convulsions'),
                confusion: isChecked('confusion'),
                vertiges: isChecked('vertiges'),
                photophobie: isChecked('photophobie'),
                
                oreille: isChecked('oreille'),
                oreilleCote: getVal('oreille-cote'),
                oreilleEcoul: getCheckedValues('oreille-ecoul').length > 0,
                ganglions: isChecked('ganglions'),
                ganglionsLoc: getVal('ganglions-loc'),
                yeux: isChecked('yeux'),
                yeuxTypes: getCheckedValues('yeux-type'),
                anosmie: isChecked('anosmie'),
                
                urinaire: isChecked('urinaire'),
                uriSignes: getCheckedValues('uri'),
                douleurLombaire: isChecked('douleur-lombaire'),
                
                douleurArticulaire: isChecked('douleur-articulaire'),
                articIntensite: getVal('artic-intensite'),
                articLoc: getCheckedValues('artic-loc'),
                douleurMembre: isChecked('douleur-membre'),
                membreType: getVal('membre-type'),
                membreSignes: getCheckedValues('membre-signe'),
                
                // Contexte alimentaire
                repasSuspect: isChecked('repas-suspect'),
                conserveMaison: isChecked('conserve-maison'),
                collectivite: isChecked('collectivite'),
                hygieneMains: isChecked('hygiene-mains'),
                baignade: isChecked('baignade'),
                
                // Neuromusculaire
                visionTrouble: isChecked('vision-trouble'),
                paupieresTombantes: isChecked('paupieres-tombantes'),
                faiblesseMusculaire: isChecked('faiblesse-musculaire'),
                difficulteParler: isChecked('difficulte-parler'),
                difficulteRespirerMuscles: isChecked('difficulte-respirer-muscles'),
                
                psyEcole: isChecked('psy-ecole'),
                psyWeekend: isChecked('psy-weekend'),
                psyRecurrent: isChecked('psy-recurrent'),
                psyEvent: isChecked('psy-event'),
                psySommeil: isChecked('psy-sommeil'),
                psyHumeur: isChecked('psy-humeur'),
                psyVerbalise: isChecked('psy-verbalise')
            };
            
            // Correction temp√©rature selon mode de mesure
            let tempCorrigee = null;
            if (data.fievre && data.temp) {
                const tempBase = parseFloat(data.temp);
                const corrections = {
                    'rectale': 0,
                    'buccale': 0.5,
                    'oreille': 0.4,
                    'front': 0.7,
                    'aisselle': 0.8
                };
                const correction = data.tempMode ? corrections[data.tempMode] || 0 : 0;
                tempCorrigee = tempBase + correction;
            }
            
            // Analyse FC
            let fcAlerte = null;
            if (data.hasFc && data.fcAge) {
                const fcInputValue = document.getElementById('fc-value')?.value;
                if (!fcInputValue || isNaN(parseInt(fcInputValue)) || parseInt(fcInputValue) < 40 || parseInt(fcInputValue) > 220) {
                    alert("Valeur de fr√©quence cardiaque invalide. Veuillez entrer un nombre entre 40 et 220.");
                    return;
                }
                data.fcValue = parseInt(fcInputValue);
            } else if (data.hasFc && !data.fcAge) {
                alert("Veuillez s√©lectionner l'√¢ge de l'enfant pour l'analyse de la FC.");
                return;
            }
            
            if (data.hasFc && data.fcValue && data.fcAge) {
                const fc = parseInt(data.fcValue);
                const fcBasesMax = { '6-8': 110, '9-12': 105, '13-15': 100 };
                const fcBasesMin = { '6-8': 70, '9-12': 65, '13-15': 60 };
                const fcBase = fcBasesMax[data.fcAge];
                
                // Correction pour fi√®vre (+10 bpm par ¬∞C au-dessus de 37)
                let fcAttendue = fcBase;
                if (tempCorrigee) {
                    fcAttendue = fcBase + (tempCorrigee - 37) * 10;
                }
                
                // Seuils tachycardie
                const seuilOrange = data.fcAge === '13-15' ? 130 : 150;
                const seuilRouge = 170;
                
                // Seuils bradycardie
                const seuilBradycardieOrange = fcBasesMin[data.fcAge] - 10;
                const seuilBradycardieRouge = 50;
                
                if (fc < seuilBradycardieRouge) {
                    fcAlerte = 'rouge';
                } else if (fc < seuilBradycardieOrange) {
                    fcAlerte = 'orange';
                } else if (fc > seuilRouge) {
                    fcAlerte = 'rouge';
                } else if (fc > seuilOrange || fc > fcAttendue + 20) {
                    fcAlerte = 'orange';
                }
            }

            // DRAPEAUX ROUGES - urgence imm√©diate
            const drapeauxRouges = [];
            
            if (data.eruptionType === 'purpura' && data.fievre) {
                drapeauxRouges.push("Purpura f√©brile - suspicion de m√©ningite/septic√©mie");
            }
            if (data.raideurNuque && data.fievre) {
                drapeauxRouges.push("Syndrome m√©ning√© (fi√®vre + raideur de nuque)");
            }
            if (data.raideurNuque && data.cephalee) {
                drapeauxRouges.push("Syndrome m√©ning√© (c√©phal√©es + raideur de nuque)");
            }
            if (data.fievre && data.cephalee && data.photophobie) {
                drapeauxRouges.push("Triade m√©ning√©e (fi√®vre + c√©phal√©es + photophobie)");
            }
            if (data.convulsions) {
                drapeauxRouges.push("Convulsions");
            }
            if (data.respiType === 'cyanose') {
                drapeauxRouges.push("Cyanose - d√©tresse respiratoire s√©v√®re");
            }
            if (data.respiType === 'tirage') {
                drapeauxRouges.push("Tirage respiratoire - d√©tresse respiratoire");
            }
            if (data.fatigueLevel === 'prostration') {
                drapeauxRouges.push("Prostration - alt√©ration s√©v√®re de l'√©tat g√©n√©ral");
            }
            if (data.confusion) {
                drapeauxRouges.push("Confusion / troubles de la conscience");
            }
            if (data.vomiType === 'sang' || data.vomiType === 'marc') {
                drapeauxRouges.push("Vomissements sanglants - h√©morragie digestive");
            }
            if (data.diarrheeCouleur === 'noire' || data.diarrheeCouleur === 'sang') {
                drapeauxRouges.push("Sang dans les selles - h√©morragie digestive");
            }
            if (data.abdoCarac.includes('defense')) {
                drapeauxRouges.push("D√©fense abdominale - possible urgence chirurgicale");
            }
            if (data.cephaleeType === 'brutal') {
                drapeauxRouges.push("C√©phal√©e brutale intense - possible urgence neurologique");
            }
            if (data.deshSignes.includes('pli') || data.deshSignes.includes('yeux') || data.deshSignes.includes('pasurines')) {
                drapeauxRouges.push("D√©shydratation s√©v√®re");
            }
            if (data.gorgeType === 'bave') {
                drapeauxRouges.push("Impossibilit√© de d√©glutir - possible √©piglottite");
            }
            if (data.paleurType === 'marbrures') {
                drapeauxRouges.push("Marbrures cutan√©es - signe de choc");
            }
            if (data.temp === '40' && data.fatigueLevel === 'marquee') {
                drapeauxRouges.push("Fi√®vre tr√®s √©lev√©e avec alt√©ration de l'√©tat g√©n√©ral");
            }
            if (data.oedemeLoc === 'levres' && (data.respiration || data.eruption)) {
                drapeauxRouges.push("Possible r√©action anaphylactique");
            }
            if (data.saignements && data.saignSignes.length >= 2 && data.fievre) {
                drapeauxRouges.push("Syndrome h√©morragique f√©brile - suspicion dengue s√©v√®re");
            }
            if (data.extremitesFroides && data.fievre) {
                drapeauxRouges.push("Extr√©mit√©s froides avec fi√®vre - signe de choc");
            }
            if (data.douleurAbdo && data.abdoCarac.includes('constante') && data.vomiFreq === 'incoercible' && data.fievre) {
                drapeauxRouges.push("Douleur abdominale intense + vomissements persistants + fi√®vre - alerte dengue s√©v√®re");
            }
            
            // SpO2 critique
            if (data.hasSpo2 && data.spo2Val === '90') {
                drapeauxRouges.push("Saturation en oxyg√®ne < 92% - d√©tresse respiratoire");
            }
            
            // FC critique
            if (fcAlerte === 'rouge') {
                const fc = parseInt(data.fcValue);
                if (fc < 50) {
                    drapeauxRouges.push("Bradycardie s√©v√®re (FC < 50 bpm)");
                } else {
                    drapeauxRouges.push("Fr√©quence cardiaque tr√®s √©lev√©e (> 170 bpm)");
                }
            }
            
            // Botulisme
            if ((data.faiblesseMusculaire || data.difficulteRespirerMuscles) && 
                (data.visionTrouble || data.paupieresTombantes || data.difficulteParler || data.gorgeType === 'bave')) {
                drapeauxRouges.push("Syndrome neurologique descendant - suspicion de botulisme - URGENCE VITALE");
            }
            if (data.difficulteRespirerMuscles) {
                drapeauxRouges.push("Paralysie respiratoire - URGENCE VITALE");
            }
            
            // Ict√®re (jaunisse)
            if (data.ictere && data.fievre) {
                drapeauxRouges.push("Ict√®re f√©brile - suspicion h√©patite ou leptospirose s√©v√®re");
            }

            // Si drapeaux rouges -> URGENCE
            if (drapeauxRouges.length > 0) {
                const scoresUrgence = calculerScores(data);
                afficherResultat('rouge', drapeauxRouges, [], data, 0, fcAlerte, scoresUrgence);
                return;
            }

            // ANALYSE DES PATHOLOGIES PROBABLES
            const pathologies = [];
            let scoreUrgence = 0;

            // Rhinopharyngite (exclure si signes de gravit√©)
            const pasDeGravite = !data.raideurNuque && !data.confusion && !data.convulsions && 
                                !data.respiType && data.fatigueLevel !== 'prostration';
            
            if (data.nez && (data.nezType === 'clair' || data.nezType === 'jaune') && 
                (!data.fievre || data.temp === '38' || data.temp === '38.5') && pasDeGravite) {
                pathologies.push({
                    nom: "Rhinopharyngite (rhume)",
                    score: 0,
                    description: "Infection virale b√©nigne des voies respiratoires sup√©rieures"
                });
            }

            // Gastro-ent√©rite (exclure si sang ou suspicion appendicite)
            const excluGastro = data.diarrheeCouleur === 'sang' || 
                               data.diarrheeCouleur === 'noire' ||
                               data.vomiType === 'sang' || 
                               data.vomiType === 'marc' ||
                               data.abdoLoc === 'fid' ||
                               data.abdoCarac.includes('migration');
            
            if ((data.vomissements || data.diarrhee) && !excluGastro) {
                let gastroScore = 0;
                if (data.vomiFreq === 'incoercible') gastroScore = 2;
                else if (data.diarrheeType === 'explosive') gastroScore = 1;
                if (data.deshydratation) gastroScore += 1;
                if (data.vertiges) gastroScore += 1; // vertiges = d√©shydratation probable
                pathologies.push({
                    nom: "Gastro-ent√©rite",
                    score: gastroScore,
                    description: "Infection digestive le plus souvent virale"
                });
                scoreUrgence = Math.max(scoreUrgence, gastroScore);
            }

            // Otite
            if (data.oreille && data.fievre) {
                let otiteScore = 1;
                if (data.oreilleCote === 'bi') otiteScore = 2; // bilat√©rale plus s√©v√®re
                if (data.oreilleEcoul) otiteScore = 2; // perfor√©e
                pathologies.push({
                    nom: data.oreilleEcoul ? "Otite moyenne perfor√©e" : "Otite moyenne aigu√´",
                    score: otiteScore,
                    description: data.oreilleEcoul ? 
                        "Infection avec perforation du tympan - consultation n√©cessaire" :
                        "Infection de l'oreille moyenne, fr√©quente chez l'enfant"
                });
                scoreUrgence = Math.max(scoreUrgence, otiteScore);
            }

            // Angine
            if (data.gorge && data.fievre && data.ganglions) {
                pathologies.push({
                    nom: "Angine",
                    score: 1,
                    description: "Infection des amygdales - test rapide (TROD) en pharmacie recommand√© pour diff√©rencier virale/bact√©rienne"
                });
                scoreUrgence = Math.max(scoreUrgence, 1);
            }

            // Grippe (moins prioritaire si signes dengue sans toux)
            const signesDengue = data.douleurYeux || (data.courbatures && data.cephalee);
            const probaDengue = signesDengue && !data.toux;
            
            if (data.fievre && (data.temp === '39' || data.temp === '40') && 
                data.frissons && (data.toux || data.cephalee) && !probaDengue) {
                pathologies.push({
                    nom: "Syndrome grippal",
                    score: 1,
                    description: "Infection virale avec fi√®vre √©lev√©e et courbatures"
                });
                scoreUrgence = Math.max(scoreUrgence, 1);
            }

            // Dengue (prioritaire en zone end√©mique)
            if (data.fievre && (data.temp === '39' || data.temp === '40') && 
                (data.douleurYeux || data.courbatures) && data.cephalee) {
                let dengueScore = 1;
                if (data.eruption) dengueScore = 1;
                if (data.saignements) dengueScore = 3;
                if (data.douleurAbdo && data.vomissements) dengueScore = 2;
                pathologies.push({
                    nom: "Suspicion de dengue",
                    score: dengueScore,
                    description: "Arbovirose transmise par moustique - surveillance √©troite recommand√©e"
                });
                scoreUrgence = Math.max(scoreUrgence, dengueScore);
            }

            // Chikungunya
            if (data.fievre && data.douleurArticulaire && 
                (data.articIntensite === 'intense' || data.articLoc.includes('multiples'))) {
                pathologies.push({
                    nom: "Suspicion de chikungunya",
                    score: 1,
                    description: "Arbovirose avec douleurs articulaires caract√©ristiques"
                });
                scoreUrgence = Math.max(scoreUrgence, 1);
            }

            // COVID-19 (crit√®res √©largis - variants r√©cents font moins d'anosmie)
            const covidTypique = data.anosmie;
            const covidProbable = data.fievre && data.toux && (data.fatigue || data.courbatures) && 
                                 !data.douleurYeux && !probaDengue; // pas dengue
            
            if (covidTypique || covidProbable) {
                pathologies.push({
                    nom: "Suspicion de COVID-19",
                    score: 1,
                    description: "Infection respiratoire - isolement et test recommand√©s"
                });
                scoreUrgence = Math.max(scoreUrgence, 1);
            }

            // Varicelle (exclure si localisation mains/pieds = plut√¥t PMB)
            const locMainsPieds = data.eruptionLoc.includes('mains') || data.eruptionLoc.includes('pieds');
            const locTronc = data.eruptionLoc.includes('tronc') || data.eruptionLoc.includes('visage');
            const plutotPMB = locMainsPieds && !locTronc && data.aphtes;
            
            if (data.eruption && data.eruptionType === 'vesicules' && data.eruptionGratte && !plutotPMB) {
                pathologies.push({
                    nom: "Varicelle",
                    score: 0,
                    description: "Infection virale b√©nigne avec v√©sicules prurigineuses"
                });
            }

            // Bronchite
            if (data.toux && data.touxType === 'grasse' && data.fievre) {
                pathologies.push({
                    nom: "Bronchite",
                    score: 1,
                    description: "Inflammation des bronches, souvent virale"
                });
                scoreUrgence = Math.max(scoreUrgence, 1);
            }

            // Laryngite (exclure si ne d√©glutit plus = √©piglottite)
            if (data.toux && data.touxType === 'aboyante' && data.voix && data.gorgeType !== 'bave') {
                let laryngiteScore = 2;
                if (data.voixType === 'eteinte') laryngiteScore = 2; // voix √©teinte = plus s√©v√®re
                pathologies.push({
                    nom: "Laryngite",
                    score: laryngiteScore,
                    description: "Inflammation du larynx avec toux caract√©ristique"
                });
                scoreUrgence = Math.max(scoreUrgence, laryngiteScore);
            }

            // Cystite
            if (data.urinaire && data.uriSignes.includes('brulure') && !data.fievre) {
                pathologies.push({
                    nom: "Infection urinaire basse (cystite)",
                    score: 1,
                    description: "Infection de la vessie"
                });
                scoreUrgence = Math.max(scoreUrgence, 1);
            }

            // Py√©lon√©phrite
            if (data.urinaire && data.fievre && data.douleurLombaire) {
                pathologies.push({
                    nom: "Py√©lon√©phrite",
                    score: 2,
                    description: "Infection du rein n√©cessitant un traitement rapide"
                });
                scoreUrgence = Math.max(scoreUrgence, 2);
            }

            // Appendicite - logique prudente
            if (data.douleurAbdo) {
                // Compter les signes √©vocateurs
                let signesAppend = 0;
                if (data.abdoAppend.includes('vomi-apres')) signesAppend++;
                if (data.abdoAppend.includes('anorexie')) signesAppend++;
                if (data.abdoAppend.includes('marche')) signesAppend++;
                if (data.abdoAppend.includes('couche')) signesAppend++;
                if (data.abdoCarac.includes('migration')) signesAppend++;
                if (data.abdoCarac.includes('augmente')) signesAppend++;
                if (data.fievre) signesAppend++;
                
                // Signes forts
                const signeFort = data.abdoLoc === 'fid' || 
                                 data.abdoCarac.includes('defense') ||
                                 data.abdoAppend.includes('marche');
                
                // Logique de d√©cision
                if (data.abdoCarac.includes('defense')) {
                    // D√©j√† couvert par drapeau rouge
                } else if (signeFort && signesAppend >= 1) {
                    pathologies.push({
                        nom: "Suspicion forte d'appendicite",
                        score: 3,
                        description: "Consultation urgente n√©cessaire - ne pas faire manger l'enfant"
                    });
                    scoreUrgence = Math.max(scoreUrgence, 3);
                } else if (signesAppend >= 2) {
                    pathologies.push({
                        nom: "Appendicite √† √©liminer",
                        score: 2,
                        description: "Plusieurs signes √©vocateurs - consultation dans la journ√©e recommand√©e"
                    });
                    scoreUrgence = Math.max(scoreUrgence, 2);
                } else if (data.abdoLoc === 'fid' || data.abdoCarac.includes('migration')) {
                    pathologies.push({
                        nom: "Appendicite possible",
                        score: 2,
                        description: "Localisation suspecte - √† surveiller de pr√®s, consulter si aggravation"
                    });
                    scoreUrgence = Math.max(scoreUrgence, 2);
                }
            }

            // Pneumonie
            if (data.fievre && (data.temp === '39' || data.temp === '40') && 
                data.toux && data.respiType === 'rapide') {
                pathologies.push({
                    nom: "Possible pneumonie",
                    score: 2,
                    description: "Infection pulmonaire n√©cessitant √©valuation m√©dicale"
                });
                scoreUrgence = Math.max(scoreUrgence, 2);
            }

            // Asthme / crise
            if (data.respiration && data.respiType === 'sifflante') {
                pathologies.push({
                    nom: "Bronchospasme / crise d'asthme",
                    score: 2,
                    description: "R√©tr√©cissement des bronches - √† surveiller de pr√®s"
                });
                scoreUrgence = Math.max(scoreUrgence, 2);
            }

            // Conjonctivite
            if (data.yeux && (data.yeuxTypes.includes('rouge') || data.yeuxTypes.includes('colles'))) {
                pathologies.push({
                    nom: "Conjonctivite",
                    score: 0,
                    description: "Inflammation de l'≈ìil, souvent virale ou allergique"
                });
            }

            // Urticaire / allergie
            if (data.eruption && data.eruptionType === 'urticaire') {
                let allergieScore = 0;
                if (data.oedeme) allergieScore = 2;
                pathologies.push({
                    nom: "Urticaire / r√©action allergique",
                    score: allergieScore,
                    description: "R√©action cutan√©e, surveiller l'√©volution"
                });
                scoreUrgence = Math.max(scoreUrgence, allergieScore);
            }

            // Syndrome pieds-mains-bouche
            if (data.eruption && data.eruptionType === 'vesicules' && 
                (data.eruptionLoc.includes('mains') || data.eruptionLoc.includes('pieds')) &&
                (data.aphtes || data.gorge)) {
                pathologies.push({
                    nom: "Syndrome pieds-mains-bouche",
                    score: 0,
                    description: "Infection virale b√©nigne (Coxsackie) - tr√®s contagieuse, gu√©rison spontan√©e en 7-10 jours"
                });
            }

            // Salmonellose / TIAC
            if ((data.diarrhee || data.vomissements) && data.fievre && 
                (data.repasSuspect || data.collectivite || data.hygieneMains)) {
                let salmoScore = 1;
                if (data.diarrheeType === 'explosive' || data.diarrheeCouleur === 'sang') salmoScore = 2;
                if (data.deshydratation) salmoScore = 2;
                pathologies.push({
                    nom: "Toxi-infection alimentaire (salmonellose probable)",
                    score: salmoScore,
                    description: "Infection bact√©rienne d'origine alimentaire - surveiller hydratation"
                });
                scoreUrgence = Math.max(scoreUrgence, salmoScore);
            }

            // Gastro-ent√©rite en collectivit√©
            if ((data.diarrhee || data.vomissements) && data.collectivite && !data.fievre) {
                pathologies.push({
                    nom: "Gastro-ent√©rite virale (contexte √©pid√©mique)",
                    score: 0,
                    description: "Probable contamination en collectivit√© - tr√®s contagieux"
                });
            }

            // Botulisme - signes pr√©coces (alerter m√™me sans conserves identifi√©es)
            const signesNeuroDescendants = (data.visionTrouble || data.paupieresTombantes) && 
                                          (data.faiblesseMusculaire || data.difficulteParler || data.gorgeType === 'avaler');
            
            if (signesNeuroDescendants) {
                let botulScore = 3;
                if (data.conserveMaison) botulScore = 3;
                pathologies.push({
                    nom: "Suspicion de botulisme - CONSULTATION URGENTE",
                    score: botulScore,
                    description: "Syndrome neurologique descendant - ne pas attendre l'aggravation"
                });
                scoreUrgence = Math.max(scoreUrgence, botulScore);
            } else if ((data.visionTrouble || data.paupieresTombantes) && data.conserveMaison) {
                pathologies.push({
                    nom: "Botulisme √† √©liminer",
                    score: 2,
                    description: "Signes oculaires + contexte alimentaire √† risque - consultation rapide"
                });
                scoreUrgence = Math.max(scoreUrgence, 2);
            }

            // Leptospirose (baignade + fi√®vre)
            if (data.fievre && data.baignade && (data.courbatures || data.cephalee)) {
                pathologies.push({
                    nom: "Suspicion de leptospirose",
                    score: 2,
                    description: "Infection bact√©rienne li√©e √† l'eau contamin√©e - consultation rapide"
                });
                scoreUrgence = Math.max(scoreUrgence, 2);
            }

            // Herpangine
            if (data.aphtes && data.fievre && data.gorge && !data.eruption) {
                pathologies.push({
                    nom: "Herpangine",
                    score: 1,
                    description: "Infection virale avec ulc√©rations buccales - douloureux mais b√©nin"
                });
                scoreUrgence = Math.max(scoreUrgence, 1);
            }

            // Mononucl√©ose infectieuse
            if (data.ganglions && data.fatigue && 
                (data.fatigueLevel === 'marquee' || data.appetit) &&
                (data.gorge || data.fievre)) {
                let monoScore = 1;
                if (data.ganglionsLoc === 'multiple') monoScore = 2;
                if (data.ictere) monoScore = 2; // atteinte h√©patique
                pathologies.push({
                    nom: "Suspicion de mononucl√©ose infectieuse",
                    score: monoScore,
                    description: "Infection virale (EBV) - fatigue prolong√©e fr√©quente, √©viter sports de contact (rate)"
                });
                scoreUrgence = Math.max(scoreUrgence, monoScore);
            }

            // H√©patite virale
            if (data.ictere && (data.fatigue || data.appetit) && 
                (data.vomissements || data.douleurAbdo)) {
                pathologies.push({
                    nom: "Suspicion d'h√©patite virale",
                    score: 2,
                    description: "Atteinte du foie - consultation rapide n√©cessaire"
                });
                scoreUrgence = Math.max(scoreUrgence, 2);
            }

            // Occlusion intestinale
            if (data.constipation && data.vomissements && data.douleurAbdo &&
                data.abdoCarac.includes('constante')) {
                pathologies.push({
                    nom: "Suspicion d'occlusion intestinale",
                    score: 3,
                    description: "Arr√™t du transit - consultation urgente n√©cessaire"
                });
                scoreUrgence = Math.max(scoreUrgence, 3);
            }

            // Arthrite
            if (data.douleurMembre && data.membreSignes.includes('gonfle') && 
                data.membreSignes.includes('rouge') && data.fievre) {
                pathologies.push({
                    nom: "Possible arthrite septique",
                    score: 2,
                    description: "Infection articulaire n√©cessitant consultation rapide"
                });
                scoreUrgence = Math.max(scoreUrgence, 2);
            }
            
            // Douleur membre sans trauma apparent
            if (data.douleurMembre && data.membreType === 'spontanee' && 
                !data.membreSignes.includes('gonfle') && data.fievre) {
                pathologies.push({
                    nom: "Douleur osseuse f√©brile √† explorer",
                    score: 2,
                    description: "Douleur spontan√©e + fi√®vre = consultation recommand√©e"
                });
                scoreUrgence = Math.max(scoreUrgence, 2);
            }

            // ANALYSE CONTEXTE PSY
            const psyScore = [data.psyEcole, data.psyWeekend, data.psyRecurrent, 
                            data.psyEvent, data.psySommeil, data.psyHumeur, 
                            data.psyVerbalise].filter(Boolean).length;

            // D√©terminer le niveau
            let niveau;
            if (scoreUrgence >= 3) {
                niveau = 'orange';
            } else if (scoreUrgence >= 2) {
                niveau = 'orange';
            } else if (scoreUrgence >= 1 || pathologies.length > 0) {
                niveau = 'jaune';
            } else {
                niveau = 'vert';
            }
            
            // Ajustement selon constantes vitales
            if (data.hasSpo2 && data.spo2Val === '92' && niveau === 'vert') {
                niveau = 'jaune';
            }
            if (data.hasSpo2 && data.spo2Val === '92' && niveau === 'jaune') {
                niveau = 'orange';
            }
            if (fcAlerte === 'orange' && (niveau === 'vert' || niveau === 'jaune')) {
                niveau = 'orange';
            }

            // Si pas de sympt√¥mes coch√©s
            const anySymptom = Object.values(data).some(v => v === true || (Array.isArray(v) && v.length > 0));
            if (!anySymptom) {
                document.getElementById('resultat').innerHTML = '<p>Veuillez cocher au moins un sympt√¥me.</p>';
                document.getElementById('resultat').style.display = 'block';
                document.getElementById('resultat').className = '';
                return;
            }

            // Calculer les scores de correspondance
            const scoresCalcules = calculerScores(data);

            afficherResultat(niveau, [], pathologies, data, psyScore, fcAlerte, scoresCalcules);
        }

        function afficherResultat(niveau, drapeauxRouges, pathologies, data, psyScore = 0, fcAlerte = null, scoresCalcules = []) {
            const resultat = document.getElementById('resultat');
            let html = '';

            const niveaux = {
                rouge: {
                    classe: 'niveau-rouge',
                    icon: 'üö®',
                    titre: 'URGENCE - Appeler le 15 ou se rendre aux urgences',
                    couleur: '#dc3545'
                },
                orange: {
                    classe: 'niveau-orange', 
                    icon: '‚ö†Ô∏è',
                    titre: 'Consultation m√©dicale dans la journ√©e',
                    couleur: '#fd7e14'
                },
                jaune: {
                    classe: 'niveau-jaune',
                    icon: 'üìã',
                    titre: 'Consultation dans les 24-48h',
                    couleur: '#ffc107'
                },
                vert: {
                    classe: 'niveau-vert',
                    icon: 'üè†',
                    titre: 'Surveillance √† domicile',
                    couleur: '#28a745'
                }
            };

            const n = niveaux[niveau];
            resultat.className = n.classe;

            html += `<h3><span class="urgence-icon">${n.icon}</span> ${n.titre}</h3>`;

            // Drapeaux rouges
            if (drapeauxRouges.length > 0) {
                html += '<div class="pathologies-probables"><h4>‚ö†Ô∏è Signes d\'alerte d√©tect√©s :</h4>';
                drapeauxRouges.forEach(d => {
                    html += `<div class="pathologie-item"><strong>${d}</strong></div>`;
                });
                html += '</div>';
                html += '<div class="conseils"><h4>Action imm√©diate :</h4>';
                html += '<ul><li><strong>Appelez le 15 (SAMU)</strong> ou le 112</li>';
                html += '<li>Ou rendez-vous aux urgences p√©diatriques les plus proches</li>';
                html += '<li>Ne donnez ni √† manger ni √† boire en attendant l\'avis m√©dical</li></ul></div>';
            }

            // Pathologies probables avec scores de confiance
            if (scoresCalcules.length > 0) {
                html += '<div class="pathologies-probables"><h4>ü©∫ Hypoth√®ses probables (par ordre de correspondance) :</h4>';
                
                scoresCalcules.forEach((p, index) => {
                    const niveauColors = {
                        vert: '#28a745',
                        jaune: '#ffc107', 
                        orange: '#fd7e14',
                        rouge: '#dc3545'
                    };
                    const niveauIcons = {
                        vert: 'üü¢',
                        jaune: 'üü°',
                        orange: 'üü†',
                        rouge: 'üî¥'
                    };
                    
                    // Barre de progression
                    const barColor = p.score >= 70 ? '#28a745' : p.score >= 50 ? '#ffc107' : '#6c757d';
                    
                    html += `<div class="pathologie-item" style="padding: 12px; margin: 8px 0; border-radius: 8px; background: ${index === 0 ? '#f0f7ff' : '#fff'}; border: 1px solid ${index === 0 ? '#007bff' : '#ddd'};">`;
                    html += `<div style="display: flex; justify-content: space-between; align-items: center;">`;
                    html += `<strong>${niveauIcons[p.niveau]} ${p.nom}</strong>`;
                    html += `<span style="background: ${barColor}; color: white; padding: 3px 10px; border-radius: 12px; font-weight: bold;">${p.score}%</span>`;
                    html += `</div>`;
                    
                    // Barre de progression visuelle
                    html += `<div style="background: #e9ecef; border-radius: 4px; height: 8px; margin: 8px 0;">`;
                    html += `<div style="background: ${barColor}; width: ${p.score}%; height: 100%; border-radius: 4px;"></div>`;
                    html += `</div>`;
                    
                    // D√©tail du score
                    html += `<small style="color: #666;">${p.matchs} sympt√¥me(s) correspondant(s) sur ${p.total} typiques`;
                    if (p.symptomesAbsentsPresents.length > 0) {
                        html += ` ‚Ä¢ <span style="color: #dc3545;">Sympt√¥mes atypiques pr√©sents</span>`;
                    }
                    html += `</small>`;
                    html += `</div>`;
                });
                
                html += '</div>';
            } else if (pathologies.length > 0) {
                // Fallback sur l'ancien syst√®me si pas de scores
                pathologies.sort((a, b) => b.score - a.score);
                html += '<div class="pathologies-probables"><h4>ü©∫ Hypoth√®ses possibles :</h4>';
                pathologies.forEach(p => {
                    html += `<div class="pathologie-item"><strong>${p.nom}</strong><br><small>${p.description}</small></div>`;
                });
                html += '</div>';
            }

            // Conseils selon niveau
            if (niveau !== 'rouge') {
                html += '<div class="conseils"><h4>üí° Conseils :</h4><ul>';
                
                if (niveau === 'orange') {
                    html += '<li>Consultez un m√©decin aujourd\'hui (m√©decin traitant, maison m√©dicale de garde)</li>';
                    html += '<li>Si aggravation : appelez le 15</li>';
                }
                
                if (niveau === 'jaune') {
                    html += '<li>Prenez rendez-vous avec votre m√©decin</li>';
                    html += '<li>En attendant, assurez hydratation et repos</li>';
                }

                if (niveau === 'vert') {
                    html += '<li>Pas de signe de gravit√© imm√©diate</li>';
                    html += '<li>Repos et hydratation</li>';
                    html += '<li>Parac√©tamol si fi√®vre ou douleur (selon posologie adapt√©e au poids)</li>';
                }

                // Conseils sp√©cifiques
                if (data.fievre) {
                    html += '<li>Fi√®vre : ne pas trop couvrir, hydrater r√©guli√®rement</li>';
                }
                if (data.vomissements || data.diarrhee) {
                    html += '<li>R√©hydratation par petites quantit√©s fr√©quentes (SRO en pharmacie)</li>';
                }
                if (data.toux && data.touxType === 'aboyante') {
                    html += '<li>Laryngite : air frais/humide peut soulager, position assise</li>';
                }
                
                // Fonction helper pour chercher dans les hypoth√®ses
                const hasPathologie = (searchTerms) => {
                    const terms = Array.isArray(searchTerms) ? searchTerms : [searchTerms];
                    return scoresCalcules.some(p => terms.some(t => p.nom.toLowerCase().includes(t.toLowerCase()))) ||
                           pathologies.some(p => terms.some(t => p.nom.toLowerCase().includes(t.toLowerCase())));
                };
                
                // Conseils arboviroses
                const suspectDengue = hasPathologie('dengue');
                const suspectChik = hasPathologie('chikungunya');
                const suspectCovid = hasPathologie('COVID');
                
                if (suspectDengue || suspectChik) {
                    html += '<li><strong>Arbovirose suspect√©e :</strong> PAS d\'aspirine ni d\'ibuprof√®ne (risque h√©morragique) - Parac√©tamol uniquement</li>';
                    html += '<li>Protection anti-moustiques pour √©viter la transmission</li>';
                    html += '<li>Hydratation ++ (eau, bouillons, SRO)</li>';
                }
                if (suspectDengue) {
                    html += '<li><strong>Dengue :</strong> Surveiller signes d\'alerte entre J3 et J7 (douleur abdominale, saignements, agitation)</li>';
                }
                if (suspectCovid) {
                    html += '<li><strong>COVID suspect√© :</strong> Isolement et test recommand√©s</li>';
                }
                
                // Conseils TIAC
                const suspectTIAC = hasPathologie(['alimentaire', 'salmonellose', 'TIAC']);
                if (suspectTIAC) {
                    html += '<li><strong>Intoxication alimentaire :</strong> Hydratation prioritaire, alimentation l√©g√®re progressive</li>';
                    html += '<li>Conserver les restes alimentaires suspects (si analyse n√©cessaire)</li>';
                }
                
                // Pieds-mains-bouche
                const suspectPMB = hasPathologie('pieds-mains-bouche');
                if (suspectPMB) {
                    html += '<li><strong>Pieds-mains-bouche :</strong> √âviction de collectivit√© jusqu\'√† gu√©rison des l√©sions</li>';
                    html += '<li>Alimentation froide/ti√®de (√©viter acide et sal√© si aphtes)</li>';
                }
                
                // Constantes vitales
                if (data.hasSpo2 && data.spo2Val === '92') {
                    html += '<li><strong>SpO2 limite (92-94%) :</strong> Surveiller de pr√®s, reconsulter si < 92%</li>';
                }
                if (fcAlerte === 'orange') {
                    const fc = parseInt(data.fcValue);
                    if (fc < 60) {
                        html += '<li><strong>Fr√©quence cardiaque basse :</strong> Peut indiquer malaise vagal, hypothermie ou autre probl√®me - surveiller</li>';
                    } else {
                        html += '<li><strong>Fr√©quence cardiaque √©lev√©e :</strong> Peut indiquer d√©shydratation, douleur ou gravit√© - surveiller</li>';
                    }
                }
                
                // Appendicite
                const suspectAppend = hasPathologie('appendicite');
                if (suspectAppend) {
                    html += '<li><strong>Suspicion appendicite :</strong> Ne pas faire manger ni boire l\'enfant en attendant l\'avis m√©dical</li>';
                    html += '<li>Ne pas donner de laxatifs ni appliquer de chaleur sur le ventre</li>';
                }
                
                // Mononucl√©ose
                const suspectMono = hasPathologie('mononucl√©ose');
                if (suspectMono) {
                    html += '<li><strong>Mononucl√©ose suspect√©e :</strong> Repos, √©viter tout sport de contact pendant 4-6 semaines (risque rupture rate)</li>';
                    html += '<li>Fatigue prolong√©e normale (peut durer plusieurs semaines)</li>';
                }
                
                // H√©patite
                const suspectHepatite = hasPathologie('h√©patite');
                if (suspectHepatite) {
                    html += '<li><strong>H√©patite suspect√©e :</strong> √âviter m√©dicaments m√©tabolis√©s par le foie (parac√©tamol avec prudence)</li>';
                    html += '<li>Hygi√®ne stricte (mains, toilettes s√©par√©es)</li>';
                }
                
                // Occlusion
                const suspectOcclusion = hasPathologie('occlusion');
                if (suspectOcclusion) {
                    html += '<li><strong>Occlusion suspect√©e :</strong> Ne rien donner √† manger ni √† boire</li>';
                }

                html += '</ul></div>';
            }

            // Surveillance
            html += '<div class="surveillance"><h4>üëÅÔ∏è Signes √† surveiller (reconsulter si) :</h4><ul>';
            html += '<li>Fi√®vre qui persiste plus de 48-72h ou s\'aggrave</li>';
            html += '<li>Apparition de difficult√©s respiratoires</li>';
            html += '<li>Prostration, somnolence inhabituelle</li>';
            html += '<li>Refus total de boire</li>';
            html += '<li>√âruption qui ne s\'efface pas √† la pression</li>';
            html += '<li>Douleur qui s\'intensifie ou se localise</li>';
            
            // Surveillance dengue sp√©cifique
            const hasDengue = scoresCalcules.some(p => p.nom.toLowerCase().includes('dengue')) || 
                             pathologies.some(p => p.nom.toLowerCase().includes('dengue'));
            if (hasDengue) {
                html += '<li><strong>‚ö†Ô∏è Dengue - signes d\'alerte :</strong> douleur abdominale intense, vomissements persistants, saignements (gencives, nez, ecchymoses), agitation ou l√©thargie, extr√©mit√©s froides</li>';
            }
            
            // Surveillance appendicite
            const hasAppend = scoresCalcules.some(p => p.nom.toLowerCase().includes('appendicite')) ||
                             pathologies.some(p => p.nom.toLowerCase().includes('appendicite'));
            if (hasAppend) {
                html += '<li><strong>‚ö†Ô∏è Appendicite - reconsulter si :</strong> douleur qui se localise en bas √† droite, fi√®vre qui appara√Æt/augmente, vomissements, enfant refuse de bouger</li>';
            }
            
            html += '<li>Tout signe qui vous inqui√®te</li>';
            html += '</ul></div>';

            // Contexte psy
            if (psyScore >= 2) {
                html += '<div class="psy-alert"><h4>üí≠ Contexte √©motionnel √† consid√©rer</h4>';
                html += '<p>Plusieurs √©l√©ments sugg√®rent un possible <strong>facteur stress/anxi√©t√©</strong> associ√© aux sympt√¥mes :</p><ul>';
                if (data.psyEcole) html += '<li>Sympt√¥mes li√©s au contexte scolaire</li>';
                if (data.psyWeekend) html += '<li>Am√©lioration hors p√©riode scolaire</li>';
                if (data.psyRecurrent) html += '<li>Plaintes r√©currentes sans cause m√©dicale identifi√©e</li>';
                if (data.psyEvent) html += '<li>√âv√©nement stressant r√©cent</li>';
                if (data.psySommeil) html += '<li>Troubles du sommeil</li>';
                if (data.psyHumeur) html += '<li>Changement d\'humeur</li>';
                if (data.psyVerbalise) html += '<li>Expression d\'anxi√©t√© ou tristesse</li>';
                html += '</ul>';
                html += '<p><strong>Cela ne signifie pas que les sympt√¥mes ne sont pas r√©els</strong> ‚Äî le stress peut provoquer de vrais sympt√¥mes physiques. ';
                html += 'Une √©coute attentive et, si besoin, un accompagnement (m√©decin, psychologue scolaire) peuvent aider.</p></div>';
            }

            resultat.innerHTML = html;
            resultat.style.display = 'block';
            resultat.scrollIntoView({ behavior: 'smooth' });
        }

        function resetForm() {
            document.querySelectorAll('input[type="checkbox"], input[type="radio"]').forEach(el => {
                el.checked = false;
            });
            document.querySelectorAll('.sub-options').forEach(el => {
                el.classList.remove('visible');
            });
            document.getElementById('resultat').style.display = 'none';
            document.getElementById('fc-value').value = '';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // ========== MODE SWITCH ==========
        function switchMode(mode) {
            document.getElementById('mode-triage').classList.remove('active');
            document.getElementById('mode-reverse').classList.remove('active');
            document.getElementById('btn-triage').classList.remove('active');
            document.getElementById('btn-reverse').classList.remove('active');
            
            document.getElementById('mode-' + mode).classList.add('active');
            document.getElementById('btn-' + mode).classList.add('active');
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // ========== BASE DE DONN√âES MALADIES ==========
        const maladiesDB = {
            rhinopharyngite: {
                nom: "Rhinopharyngite (rhume)",
                description: "Infection virale b√©nigne des voies respiratoires sup√©rieures. Tr√®s fr√©quente, gu√©rit spontan√©ment en 7-10 jours.",
                niveau: "vert",
                symptomes: [
                    "Nez qui coule (clair puis jaune-vert)",
                    "√âternuements",
                    "Toux l√©g√®re",
                    "Fi√®vre mod√©r√©e (< 38.5¬∞C)",
                    "Mal de gorge l√©ger",
                    "L√©g√®re fatigue"
                ],
                absents: [
                    "Fi√®vre √©lev√©e (> 39¬∞C)",
                    "Difficult√©s respiratoires",
                    "Raideur de nuque",
                    "Prostration"
                ],
                alertes: [
                    "Fi√®vre > 38.5¬∞C persistant plus de 48-72h",
                    "Douleur d'oreille (otite secondaire)",
                    "Difficult√©s respiratoires",
                    "Refus de boire"
                ],
                conseils: [
                    "Hydratation r√©guli√®re",
                    "Lavage de nez au s√©rum physiologique",
                    "Repos",
                    "Parac√©tamol si fi√®vre ou inconfort"
                ],
                nonFaire: [
                    "Antibiotiques (inefficaces contre les virus)"
                ]
            },
            angine: {
                nom: "Angine",
                description: "Infection des amygdales, virale (70-80%) ou bact√©rienne (streptocoque). Le test rapide (TROD) en pharmacie permet de diff√©rencier.",
                niveau: "jaune",
                symptomes: [
                    "Mal de gorge intense",
                    "Difficult√© √† avaler",
                    "Fi√®vre (38-39¬∞C)",
                    "Ganglions du cou gonfl√©s et douloureux",
                    "Amygdales rouges ¬± d√©p√¥ts blancs",
                    "Perte d'app√©tit"
                ],
                absents: [
                    "Toux (plut√¥t viral si pr√©sente)",
                    "Nez qui coule (plut√¥t viral)",
                    "Impossibilit√© totale d'avaler / bave"
                ],
                alertes: [
                    "Impossibilit√© de d√©glutir / bave ‚Üí √©piglottite = URGENCE",
                    "Difficult√©s respiratoires",
                    "Gonflement du cou important",
                    "Fi√®vre persistante malgr√© traitement"
                ],
                conseils: [
                    "Test rapide streptocoque (TROD) en pharmacie",
                    "Si TROD positif ‚Üí consultation pour antibiotiques",
                    "Parac√©tamol pour la douleur et fi√®vre",
                    "Alimentation froide/ti√®de (moins douloureux)"
                ],
                nonFaire: [
                    "Antibiotiques sans test positif"
                ]
            },
            otite: {
                nom: "Otite moyenne aigu√´",
                description: "Infection de l'oreille moyenne, tr√®s fr√©quente chez l'enfant. Souvent complication d'un rhume.",
                niveau: "jaune",
                symptomes: [
                    "Douleur d'oreille (souvent intense)",
                    "Fi√®vre",
                    "Irritabilit√©, pleurs",
                    "Enfant qui se touche l'oreille",
                    "Parfois √©coulement si tympan perfor√©",
                    "Baisse d'audition transitoire"
                ],
                absents: [
                    "Raideur de nuque",
                    "√âruption cutan√©e"
                ],
                alertes: [
                    "Gonflement/rougeur derri√®re l'oreille (masto√Ødite)",
                    "Fi√®vre tr√®s √©lev√©e persistante",
                    "Troubles de l'√©quilibre importants",
                    "Paralysie du visage"
                ],
                conseils: [
                    "Consultation m√©dicale recommand√©e",
                    "Parac√©tamol pour la douleur",
                    "Position semi-assise pour dormir",
                    "Ne pas mettre d'eau dans l'oreille"
                ],
                nonFaire: [
                    "Mettre des gouttes sans avis m√©dical (si tympan perfor√©)"
                ]
            },
            laryngite: {
                nom: "Laryngite",
                description: "Inflammation du larynx avec ≈ìd√®me. Toux caract√©ristique 'aboyante'. Souvent nocturne. Fr√©quente entre 1 et 6 ans mais possible jusqu'√† 15 ans.",
                niveau: "orange",
                symptomes: [
                    "Toux rauque, aboyante (comme un chien/phoque)",
                    "Voix enrou√©e ou √©teinte",
                    "Respiration bruyante √† l'inspiration (stridor)",
                    "Aggravation nocturne",
                    "Fi√®vre mod√©r√©e",
                    "Rhume pr√©alable fr√©quent"
                ],
                absents: [
                    "Bave / impossibilit√© d'avaler (‚Üí √©piglottite)",
                    "Fi√®vre tr√®s √©lev√©e d'embl√©e"
                ],
                alertes: [
                    "Difficult√©s respiratoires marqu√©es",
                    "Tirage (creuse sous les c√¥tes)",
                    "Cyanose (l√®vres bleues)",
                    "Enfant qui bave, ne peut pas avaler ‚Üí URGENCE (√©piglottite)",
                    "Agitation ou prostration"
                ],
                conseils: [
                    "Calmer l'enfant (l'agitation aggrave)",
                    "Air frais (ouvrir fen√™tre, sortir quelques minutes)",
                    "Air humide (salle de bain avec eau chaude)",
                    "Position assise ou semi-assise",
                    "Consulter si difficult√©s respiratoires"
                ],
                nonFaire: [
                    "Allonger l'enfant √† plat",
                    "Paniquer (√ßa aggrave)"
                ]
            },
            bronchite: {
                nom: "Bronchite",
                description: "Inflammation des bronches, le plus souvent virale. Gu√©rit spontan√©ment en 2-3 semaines.",
                niveau: "jaune",
                symptomes: [
                    "Toux initialement s√®che puis grasse",
                    "Expectorations (crachats)",
                    "Fi√®vre mod√©r√©e",
                    "Fatigue",
                    "Douleur thoracique possible √† la toux",
                    "Sifflements possibles"
                ],
                absents: [
                    "Fi√®vre tr√®s √©lev√©e persistante (‚Üí pneumonie)",
                    "Difficult√©s respiratoires marqu√©es"
                ],
                alertes: [
                    "Fi√®vre > 39¬∞C persistant > 48h",
                    "Difficult√©s respiratoires",
                    "Douleur thoracique au repos",
                    "Crachats sanglants"
                ],
                conseils: [
                    "Hydratation +++",
                    "Repos",
                    "Parac√©tamol si fi√®vre",
                    "Humidifier l'air ambiant"
                ],
                nonFaire: [
                    "Antibiotiques (inefficaces si viral)",
                    "Antitussifs si toux grasse (la toux √©vacue les s√©cr√©tions)"
                ]
            },
            pneumonie: {
                nom: "Pneumonie",
                description: "Infection du poumon, bact√©rienne ou virale. N√©cessite une √©valuation m√©dicale et souvent des antibiotiques.",
                niveau: "orange",
                symptomes: [
                    "Fi√®vre √©lev√©e (> 39¬∞C)",
                    "Toux (s√®che ou grasse)",
                    "Respiration rapide",
                    "Difficult√©s respiratoires",
                    "Fatigue marqu√©e",
                    "Douleur thoracique / abdominale",
                    "Frissons"
                ],
                absents: [
                    "√âtat g√©n√©ral conserv√© avec activit√© normale"
                ],
                alertes: [
                    "Difficult√©s respiratoires importantes",
                    "Cyanose (l√®vres/ongles bleus)",
                    "SpO2 < 94%",
                    "Prostration",
                    "Refus de boire"
                ],
                conseils: [
                    "Consultation m√©dicale n√©cessaire",
                    "Radio pulmonaire souvent indiqu√©e",
                    "Antibiotiques si bact√©rienne",
                    "Surveillance √©troite"
                ],
                nonFaire: []
            },
            grippe: {
                nom: "Grippe (Influenza)",
                description: "Infection virale saisonni√®re. D√©but brutal avec fi√®vre √©lev√©e et courbatures intenses.",
                niveau: "jaune",
                symptomes: [
                    "Fi√®vre √©lev√©e d'apparition brutale (> 39¬∞C)",
                    "Frissons intenses",
                    "Courbatures / douleurs musculaires +++",
                    "Maux de t√™te",
                    "Fatigue intense",
                    "Toux s√®che",
                    "Mal de gorge"
                ],
                absents: [
                    "Douleur r√©tro-orbitaire (‚Üí plut√¥t dengue)",
                    "√âruption cutan√©e"
                ],
                alertes: [
                    "Difficult√©s respiratoires",
                    "Douleur thoracique",
                    "Confusion",
                    "Fi√®vre persistante > 5 jours"
                ],
                conseils: [
                    "Repos au lit",
                    "Hydratation abondante",
                    "Parac√©tamol pour fi√®vre et douleurs",
                    "Isolement pour √©viter contagion"
                ],
                nonFaire: [
                    "Aspirine chez l'enfant (syndrome de Reye)"
                ]
            },
            covid: {
                nom: "COVID-19",
                description: "Infection respiratoire par SARS-CoV-2. Formes g√©n√©ralement b√©nignes chez l'enfant mais surveillance n√©cessaire.",
                niveau: "jaune",
                symptomes: [
                    "Fi√®vre",
                    "Toux",
                    "Fatigue",
                    "Perte d'odorat et/ou de go√ªt (anosmie/agueusie)",
                    "Maux de t√™te",
                    "Courbatures",
                    "Mal de gorge",
                    "Diarrh√©e possible"
                ],
                absents: [
                    "Douleur r√©tro-orbitaire (‚Üí dengue)"
                ],
                alertes: [
                    "Difficult√©s respiratoires",
                    "Douleur thoracique",
                    "Confusion",
                    "√âruption cutan√©e + fi√®vre persistante (MIS-C)"
                ],
                conseils: [
                    "Test de d√©pistage",
                    "Isolement",
                    "Repos et hydratation",
                    "Parac√©tamol si fi√®vre"
                ],
                nonFaire: []
            },
            gastro: {
                nom: "Gastro-ent√©rite",
                description: "Infection digestive virale (rotavirus, norovirus...) ou bact√©rienne. Tr√®s contagieuse. Gu√©rit en 2-5 jours.",
                niveau: "jaune",
                symptomes: [
                    "Vomissements",
                    "Diarrh√©e liquide",
                    "Douleurs abdominales (crampes)",
                    "Fi√®vre mod√©r√©e",
                    "Naus√©es",
                    "Perte d'app√©tit"
                ],
                absents: [
                    "Sang dans les selles (‚Üí bact√©rien/autre)",
                    "Douleur localis√©e en bas √† droite (‚Üí appendicite)"
                ],
                alertes: [
                    "Signes de d√©shydratation (pli cutan√©, yeux creux, pas d'urines > 8h)",
                    "Vomissements incoercibles (ne garde rien)",
                    "Sang dans les selles ou vomissements",
                    "Douleur abdominale qui se localise",
                    "Fi√®vre √©lev√©e persistante"
                ],
                conseils: [
                    "R√©hydratation +++ (SRO en pharmacie)",
                    "Petites quantit√©s fr√©quentes",
                    "Reprendre alimentation progressive",
                    "Hygi√®ne des mains stricte"
                ],
                nonFaire: [
                    "Boissons sucr√©es type soda (aggrave diarrh√©e)",
                    "Anti-diarrh√©iques sans avis m√©dical"
                ]
            },
            tiac: {
                nom: "Toxi-infection alimentaire (TIAC / Salmonellose)",
                description: "Intoxication par aliments contamin√©s (bact√©ries, toxines). D√©but 6-48h apr√®s ingestion.",
                niveau: "orange",
                symptomes: [
                    "Vomissements",
                    "Diarrh√©e (parfois sanglante)",
                    "Douleurs abdominales intenses",
                    "Fi√®vre",
                    "Repas suspect dans les 48h pr√©c√©dentes",
                    "Souvent plusieurs personnes atteintes"
                ],
                absents: [
                    "Sympt√¥mes neurologiques (‚Üí botulisme)"
                ],
                alertes: [
                    "D√©shydratation s√©v√®re",
                    "Sang abondant dans les selles",
                    "Fi√®vre tr√®s √©lev√©e",
                    "Signes neurologiques (vision trouble, faiblesse) ‚Üí botulisme"
                ],
                conseils: [
                    "R√©hydratation prioritaire",
                    "Conserver les restes alimentaires suspects",
                    "Consultation m√©dicale recommand√©e",
                    "Signalement si cas group√©s"
                ],
                nonFaire: [
                    "Anti-diarrh√©iques (retiennent les toxines)"
                ]
            },
            appendicite: {
                nom: "Appendicite",
                description: "Inflammation de l'appendice. Urgence chirurgicale. Peut √™tre atypique chez l'enfant. Le diagnostic pr√©coce est crucial.",
                niveau: "orange",
                symptomes: [
                    "Douleur abdominale initialement autour du nombril",
                    "Migration de la douleur vers le bas-ventre droit (FID)",
                    "Douleur qui augmente progressivement",
                    "Vomissements APR√àS le d√©but de la douleur",
                    "Perte d'app√©tit",
                    "Fi√®vre mod√©r√©e (37.5-38.5¬∞C)",
                    "Marche courb√© / refuse de sauter",
                    "Position en chien de fusil"
                ],
                absents: [
                    "Diarrh√©e importante (‚Üí plut√¥t gastro)",
                    "Vomissements AVANT la douleur (‚Üí plut√¥t gastro)"
                ],
                alertes: [
                    "Ventre dur (d√©fense abdominale)",
                    "Douleur au rel√¢chement (rebond)",
                    "Fi√®vre qui augmente",
                    "Aggravation rapide"
                ],
                conseils: [
                    "Consultation urgente n√©cessaire",
                    "NE PAS faire manger ni boire",
                    "NE PAS donner de laxatifs",
                    "NE PAS appliquer de chaleur sur le ventre"
                ],
                nonFaire: [
                    "Attendre en cas de doute",
                    "Donner √† manger ou √† boire",
                    "Laxatifs",
                    "Chaleur sur le ventre"
                ]
            },
            occlusion: {
                nom: "Occlusion intestinale",
                description: "Arr√™t du transit intestinal. Urgence chirurgicale. Plusieurs causes possibles.",
                niveau: "rouge",
                symptomes: [
                    "Douleurs abdominales intenses",
                    "Vomissements r√©p√©t√©s (devenant verd√¢tres/f√©calo√Ødes)",
                    "Arr√™t des selles et des gaz",
                    "Ventre ballonn√©",
                    "Bruits intestinaux anormaux"
                ],
                absents: [
                    "Diarrh√©e"
                ],
                alertes: [
                    "Tous les sympt√¥mes ci-dessus constituent une urgence"
                ],
                conseils: [
                    "Urgences imm√©diatement",
                    "NE RIEN donner √† manger ni √† boire"
                ],
                nonFaire: [
                    "Attendre",
                    "Alimentation ou boisson",
                    "Laxatifs"
                ]
            },
            hepatite: {
                nom: "H√©patite virale",
                description: "Infection du foie. H√©patite A (f√©co-orale), B et C (sang). Peut √™tre asymptomatique ou s√©v√®re.",
                niveau: "orange",
                symptomes: [
                    "Jaunisse (ict√®re) : yeux et peau jaunes",
                    "Fatigue intense",
                    "Perte d'app√©tit",
                    "Naus√©es, vomissements",
                    "Douleur sous les c√¥tes √† droite",
                    "Urines fonc√©es (couleur th√©)",
                    "Selles d√©color√©es"
                ],
                absents: [],
                alertes: [
                    "Confusion (enc√©phalopathie h√©patique)",
                    "Saignements spontan√©s",
                    "Jaunisse intense d'aggravation rapide"
                ],
                conseils: [
                    "Consultation m√©dicale n√©cessaire",
                    "Repos strict",
                    "Hygi√®ne rigoureuse (h√©patite A tr√®s contagieuse)",
                    "√âviter m√©dicaments h√©patotoxiques"
                ],
                nonFaire: [
                    "Parac√©tamol √† fortes doses (h√©patotoxique)",
                    "Alcool (√©vident mais √† rappeler aux ados)"
                ]
            },
            varicelle: {
                nom: "Varicelle",
                description: "Infection virale tr√®s contagieuse (VZV). B√©nigne chez l'enfant immunocomp√©tent. Une seule fois dans la vie.",
                niveau: "vert",
                symptomes: [
                    "√âruption v√©siculeuse (petites cloques remplies de liquide)",
                    "L√©sions d'√¢ges diff√©rents (boutons ‚Üí v√©sicules ‚Üí cro√ªtes)",
                    "D√©mangeaisons intenses",
                    "Localisation : tronc, visage, cuir chevelu",
                    "Fi√®vre mod√©r√©e",
                    "Fatigue"
                ],
                absents: [
                    "Localisation mains/pieds pr√©dominante (‚Üí pieds-mains-bouche)",
                    "Fi√®vre √©lev√©e persistante"
                ],
                alertes: [
                    "Surinfection des l√©sions (pus, rougeur √©tendue, fi√®vre)",
                    "Difficult√©s respiratoires",
                    "Troubles neurologiques",
                    "L√©sions dans les yeux"
                ],
                conseils: [
                    "√âviction scolaire jusqu'√† cro√ªtes (environ 7 jours)",
                    "Antihistaminique pour les d√©mangeaisons",
                    "Ongles courts et propres",
                    "Bains courts √† l'eau ti√®de",
                    "Parac√©tamol si fi√®vre"
                ],
                nonFaire: [
                    "Aspirine (syndrome de Reye)",
                    "Ibuprof√®ne (risque de complications cutan√©es)",
                    "Gratter (cicatrices)"
                ]
            },
            pmb: {
                nom: "Syndrome pieds-mains-bouche",
                description: "Infection virale (Coxsackie). Tr√®s contagieuse. B√©nigne. Gu√©rit en 7-10 jours.",
                niveau: "vert",
                symptomes: [
                    "V√©sicules sur paumes des mains",
                    "V√©sicules sur plantes des pieds",
                    "Aphtes / v√©sicules dans la bouche",
                    "Parfois √©ruption sur fesses",
                    "Fi√®vre mod√©r√©e",
                    "Refus de manger (douleur buccale)"
                ],
                absents: [
                    "V√©sicules sur le tronc (‚Üí varicelle)"
                ],
                alertes: [
                    "D√©shydratation (refus de boire)",
                    "Fi√®vre √©lev√©e persistante",
                    "Signes neurologiques (rare)"
                ],
                conseils: [
                    "Alimentation froide et liquide",
                    "√âviter aliments acides ou sal√©s",
                    "Parac√©tamol",
                    "√âviction de collectivit√© jusqu'√† gu√©rison des l√©sions"
                ],
                nonFaire: [
                    "Forcer √† manger"
                ]
            },
            urticaire: {
                nom: "Urticaire / R√©action allergique",
                description: "R√©action cutan√©e allergique ou non. G√©n√©ralement b√©nigne mais surveiller signes de gravit√©.",
                niveau: "jaune",
                symptomes: [
                    "Plaques rouges en relief",
                    "D√©mangeaisons intenses",
                    "Plaques migratrices (changent de place)",
                    "Apparition rapide",
                    "Gonflement possible (paupi√®res, l√®vres)"
                ],
                absents: [
                    "Difficult√©s respiratoires (sinon = anaphylaxie)"
                ],
                alertes: [
                    "Gonflement des l√®vres/langue/gorge ‚Üí URGENCE",
                    "Difficult√©s respiratoires ‚Üí URGENCE",
                    "Malaise, chute de tension ‚Üí URGENCE"
                ],
                conseils: [
                    "Antihistaminique",
                    "Identifier l'allerg√®ne si possible",
                    "Consultation si r√©cidive ou √©tendu"
                ],
                nonFaire: []
            },
            dengue: {
                nom: "Dengue",
                description: "Arbovirose transmise par moustique (Aedes). End√©mique aux Antilles. Surveillance J3-J7 cruciale.",
                niveau: "orange",
                symptomes: [
                    "Fi√®vre √©lev√©e brutale (> 39¬∞C)",
                    "Douleur intense derri√®re les yeux (r√©tro-orbitaire)",
                    "C√©phal√©es intenses",
                    "Courbatures / douleurs musculaires intenses",
                    "Fatigue marqu√©e",
                    "√âruption cutan√©e possible (J2-J5)",
                    "Naus√©es"
                ],
                absents: [
                    "Toux importante (‚Üí plut√¥t grippe)",
                    "Douleurs articulaires pr√©dominantes (‚Üí chikungunya)"
                ],
                alertes: [
                    "Douleur abdominale intense",
                    "Vomissements persistants",
                    "Saignements (gencives, nez, ecchymoses)",
                    "Agitation ou l√©thargie",
                    "Extr√©mit√©s froides",
                    "Chute brutale de la fi√®vre + malaise ‚Üí dengue s√©v√®re"
                ],
                conseils: [
                    "Parac√©tamol UNIQUEMENT",
                    "Hydratation +++",
                    "Repos",
                    "Protection anti-moustiques (√©viter transmission)",
                    "Surveillance √©troite J3-J7"
                ],
                nonFaire: [
                    "Aspirine (risque h√©morragique)",
                    "Ibuprof√®ne (risque h√©morragique)",
                    "AINS"
                ]
            },
            chikungunya: {
                nom: "Chikungunya",
                description: "Arbovirose transmise par moustique. Caract√©ris√©e par des douleurs articulaires intenses et invalidantes.",
                niveau: "jaune",
                symptomes: [
                    "Fi√®vre √©lev√©e brutale",
                    "Douleurs articulaires intenses (poignets, chevilles, doigts)",
                    "Gonflements articulaires",
                    "√âruption cutan√©e fr√©quente",
                    "C√©phal√©es",
                    "Courbatures"
                ],
                absents: [
                    "Douleur r√©tro-orbitaire marqu√©e (‚Üí dengue)"
                ],
                alertes: [
                    "Signes neurologiques",
                    "D√©shydratation",
                    "Formes s√©v√®res chez le petit enfant"
                ],
                conseils: [
                    "Parac√©tamol UNIQUEMENT",
                    "Hydratation",
                    "Repos",
                    "Protection anti-moustiques"
                ],
                nonFaire: [
                    "Aspirine",
                    "Ibuprof√®ne",
                    "AINS (√† √©viter initialement)"
                ]
            },
            leptospirose: {
                nom: "Leptospirose",
                description: "Infection bact√©rienne li√©e √† l'eau/boue contamin√©e par urines de rongeurs. Fr√©quente apr√®s baignade en rivi√®re.",
                niveau: "orange",
                symptomes: [
                    "Fi√®vre √©lev√©e",
                    "C√©phal√©es intenses",
                    "Courbatures intenses (mollets ++)",
                    "Conjonctivite (yeux rouges)",
                    "Jaunisse possible",
                    "Contexte : baignade rivi√®re/mare"
                ],
                absents: [],
                alertes: [
                    "Jaunisse (atteinte h√©patique)",
                    "Oligurie (peu d'urines ‚Üí atteinte r√©nale)",
                    "Saignements",
                    "Confusion"
                ],
                conseils: [
                    "Consultation m√©dicale rapide",
                    "Antibiotiques n√©cessaires",
                    "Signaler la baignade au m√©decin"
                ],
                nonFaire: []
            },
            mononucleose: {
                nom: "Mononucl√©ose infectieuse",
                description: "Infection virale (EBV). 'Maladie du baiser'. Fatigue prolong√©e fr√©quente. Rate fragile pendant plusieurs semaines.",
                niveau: "jaune",
                symptomes: [
                    "Fatigue intense et prolong√©e",
                    "Ganglions gonfl√©s (cou surtout)",
                    "Angine avec d√©p√¥ts blancs",
                    "Fi√®vre prolong√©e (1-2 semaines)",
                    "Perte d'app√©tit",
                    "Parfois √©ruption (surtout si ampicilline donn√©e)"
                ],
                absents: [
                    "Signes respiratoires importants"
                ],
                alertes: [
                    "Douleur brutale flanc gauche (rupture rate)",
                    "Difficult√©s respiratoires (gros ganglions)",
                    "Jaunisse"
                ],
                conseils: [
                    "Repos +++",
                    "PAS de sport de contact pendant 4-6 semaines (rate fragile)",
                    "Parac√©tamol",
                    "La fatigue peut durer plusieurs semaines"
                ],
                nonFaire: [
                    "Sports de contact",
                    "Ampicilline/amoxicilline (√©ruption quasi constante)"
                ]
            },
            cystite: {
                nom: "Cystite (infection urinaire basse)",
                description: "Infection de la vessie. Plus fr√©quente chez les filles. Sans fi√®vre (sinon = py√©lon√©phrite).",
                niveau: "jaune",
                symptomes: [
                    "Br√ªlures en urinant",
                    "Envies fr√©quentes d'uriner",
                    "Petites quantit√©s √† chaque fois",
                    "Urines troubles ou malodorantes",
                    "Douleur sus-pubienne",
                    "PAS de fi√®vre"
                ],
                absents: [
                    "Fi√®vre (sinon = py√©lon√©phrite)"
                ],
                alertes: [
                    "Apparition de fi√®vre",
                    "Douleur lombaire",
                    "Sang dans les urines abondant"
                ],
                conseils: [
                    "Consultation m√©dicale pour analyse d'urines",
                    "Boire beaucoup",
                    "Uriner fr√©quemment"
                ],
                nonFaire: [
                    "Se retenir d'uriner"
                ]
            },
            pyelonephrite: {
                nom: "Py√©lon√©phrite",
                description: "Infection du rein. Plus grave que la cystite. N√©cessite antibiotiques et parfois hospitalisation.",
                niveau: "orange",
                symptomes: [
                    "Fi√®vre √©lev√©e",
                    "Douleur lombaire (un c√¥t√©)",
                    "Frissons",
                    "Signes urinaires (br√ªlures, fr√©quence)",
                    "Naus√©es/vomissements possibles",
                    "Fatigue"
                ],
                absents: [],
                alertes: [
                    "Fi√®vre tr√®s √©lev√©e persistante",
                    "Vomissements emp√™chant traitement oral",
                    "Alt√©ration √©tat g√©n√©ral"
                ],
                conseils: [
                    "Consultation m√©dicale urgente",
                    "Antibiotiques indispensables",
                    "Bilan sanguin et ECBU"
                ],
                nonFaire: []
            },
            herpangine: {
                nom: "Herpangine",
                description: "Infection virale proche du pieds-mains-bouche. Ulc√©rations uniquement dans la bouche/gorge.",
                niveau: "jaune",
                symptomes: [
                    "V√©sicules/ulc√©rations au fond de la gorge",
                    "Fi√®vre √©lev√©e",
                    "Mal de gorge intense",
                    "Refus de manger (douleur)",
                    "Hypersalivation"
                ],
                absents: [
                    "√âruption cutan√©e sur les mains/pieds (sinon = PMB)"
                ],
                alertes: [
                    "D√©shydratation",
                    "Fi√®vre persistante > 5 jours"
                ],
                conseils: [
                    "Alimentation froide et liquide",
                    "Parac√©tamol",
                    "√âviter acide et sal√©"
                ],
                nonFaire: []
            },
            conjonctivite: {
                nom: "Conjonctivite",
                description: "Inflammation de la conjonctive. Virale (la plus fr√©quente), bact√©rienne ou allergique.",
                niveau: "vert",
                symptomes: [
                    "≈íil rouge",
                    "Larmoiement",
                    "S√©cr√©tions (claires = viral/allergique, purulentes = bact√©rien)",
                    "Paupi√®res coll√©es au r√©veil",
                    "Sensation de grain de sable",
                    "D√©mangeaisons si allergique"
                ],
                absents: [
                    "Douleur intense (‚Üí autre cause)",
                    "Baisse de vision (‚Üí autre cause)",
                    "Photophobie intense"
                ],
                alertes: [
                    "Douleur oculaire intense",
                    "Baisse de vision",
                    "Atteinte d'un seul ≈ìil avec douleur",
                    "Photophobie marqu√©e"
                ],
                conseils: [
                    "Nettoyage au s√©rum physiologique",
                    "Consultation si purulent (possible collyre antibiotique)",
                    "Lavage des mains fr√©quent",
                    "Ne pas partager les linges"
                ],
                nonFaire: [
                    "Mettre des collyres sans avis m√©dical"
                ]
            },
            meningite: {
                nom: "M√©ningite",
                description: "Infection des m√©ninges. URGENCE VITALE. Bact√©rienne (grave) ou virale (moins grave). Tout retard peut √™tre fatal.",
                niveau: "rouge",
                symptomes: [
                    "Fi√®vre √©lev√©e",
                    "C√©phal√©es intenses",
                    "Raideur de nuque (ne peut pas toucher poitrine avec menton)",
                    "Photophobie (g√™n√© par la lumi√®re)",
                    "Vomissements en jet",
                    "Confusion / somnolence",
                    "Purpura (taches qui ne s'effacent pas) ‚Üí M√âNINGOCOQUE"
                ],
                absents: [],
                alertes: [
                    "TOUS ces sympt√¥mes sont des alertes",
                    "Purpura = URGENCE ABSOLUE (appeler 15)"
                ],
                conseils: [
                    "APPELER LE 15 IMM√âDIATEMENT",
                    "Ne pas attendre"
                ],
                nonFaire: [
                    "Attendre",
                    "Essayer de traiter soi-m√™me"
                ]
            },
            botulisme: {
                nom: "Botulisme",
                description: "Intoxication par toxine botulique (conserves maison). Paralysie descendante. URGENCE VITALE.",
                niveau: "rouge",
                symptomes: [
                    "Vision trouble / double (diplopie)",
                    "Paupi√®res tombantes",
                    "Difficult√©s √† parler (voix faible)",
                    "Difficult√©s √† avaler",
                    "Faiblesse musculaire descendante",
                    "Constipation",
                    "Bouche s√®che",
                    "Contexte : conserves maison 12-48h avant"
                ],
                absents: [
                    "Fi√®vre (habituellement absent)"
                ],
                alertes: [
                    "TOUS ces sympt√¥mes sont des alertes",
                    "Difficult√©s respiratoires = URGENCE EXTR√äME"
                ],
                conseils: [
                    "APPELER LE 15 IMM√âDIATEMENT",
                    "Ne pas attendre l'aggravation",
                    "Conserver les aliments suspects"
                ],
                nonFaire: [
                    "Attendre"
                ]
            },
            arthrite_septique: {
                nom: "Arthrite septique",
                description: "Infection bact√©rienne d'une articulation. Urgence pour pr√©server l'articulation.",
                niveau: "orange",
                symptomes: [
                    "Articulation gonfl√©e",
                    "Articulation rouge et chaude",
                    "Douleur intense au mouvement",
                    "Refus d'utiliser le membre / boiterie",
                    "Fi√®vre",
                    "Impotence fonctionnelle totale"
                ],
                absents: [],
                alertes: [
                    "Tous ces sympt√¥mes n√©cessitent consultation urgente"
                ],
                conseils: [
                    "Consultation urgente",
                    "Ne pas mobiliser l'articulation",
                    "Ponction articulaire souvent n√©cessaire"
                ],
                nonFaire: [
                    "Anti-inflammatoires avant diagnostic",
                    "Masser ou mobiliser"
                ]
            },
            anaphylaxie: {
                nom: "R√©action anaphylactique",
                description: "R√©action allergique s√©v√®re g√©n√©ralis√©e. URGENCE VITALE. Peut √©voluer tr√®s rapidement.",
                niveau: "rouge",
                symptomes: [
                    "Urticaire / √©ruption g√©n√©ralis√©e",
                    "Gonflement visage / l√®vres / langue",
                    "Difficult√©s respiratoires",
                    "Oppression thoracique",
                    "Malaise / vertige",
                    "Naus√©es / vomissements",
                    "P√¢leur",
                    "Pouls rapide"
                ],
                absents: [],
                alertes: [
                    "TOUS ces sympt√¥mes sont des alertes majeures"
                ],
                conseils: [
                    "APPELER LE 15 IMM√âDIATEMENT",
                    "Adr√©naline si stylo disponible (Anapen, EpiPen)",
                    "Position allong√©e jambes sur√©lev√©es (sauf si g√™ne respiratoire)",
                    "Ne jamais laisser seul"
                ],
                nonFaire: [
                    "Attendre",
                    "Faire asseoir ou debout si malaise"
                ]
            }
        };
        
        // ========== SYST√àME DE SCORING ==========
        const maladiesScoring = {
            rhinopharyngite: {
                nom: "Rhinopharyngite (rhume)",
                niveau: "vert",
                symptomes: [
                    { champ: 'nez', condition: true },
                    { champ: 'nezType', condition: ['clair', 'jaune'] },
                    { champ: 'toux', condition: true },
                    { champ: 'touxType', condition: 'seche' },
                    { champ: 'fievre', condition: true },
                    { champ: 'temp', condition: ['38', '38.5'] },
                    { champ: 'gorge', condition: true },
                    { champ: 'fatigue', condition: true }
                ],
                absents: [
                    { champ: 'temp', condition: ['39', '40'] },
                    { champ: 'raideurNuque', condition: true },
                    { champ: 'respiType', condition: ['tirage', 'cyanose'] }
                ]
            },
            angine: {
                nom: "Angine",
                niveau: "jaune",
                symptomes: [
                    { champ: 'gorge', condition: true },
                    { champ: 'gorgeType', condition: ['douleur', 'avaler'] },
                    { champ: 'fievre', condition: true },
                    { champ: 'ganglions', condition: true },
                    { champ: 'appetit', condition: true }
                ],
                absents: [
                    { champ: 'toux', condition: true },
                    { champ: 'nez', condition: true },
                    { champ: 'gorgeType', condition: 'bave' }
                ]
            },
            otite: {
                nom: "Otite moyenne aigu√´",
                niveau: "jaune",
                symptomes: [
                    { champ: 'oreille', condition: true },
                    { champ: 'fievre', condition: true },
                    { champ: 'oreilleEcoul', condition: true }
                ],
                absents: [
                    { champ: 'raideurNuque', condition: true }
                ]
            },
            laryngite: {
                nom: "Laryngite",
                niveau: "orange",
                symptomes: [
                    { champ: 'toux', condition: true },
                    { champ: 'touxType', condition: 'aboyante' },
                    { champ: 'voix', condition: true },
                    { champ: 'voixType', condition: ['enrouee', 'eteinte'] },
                    { champ: 'fievre', condition: true },
                    { champ: 'nez', condition: true }
                ],
                absents: [
                    { champ: 'gorgeType', condition: 'bave' }
                ]
            },
            bronchite: {
                nom: "Bronchite",
                niveau: "jaune",
                symptomes: [
                    { champ: 'toux', condition: true },
                    { champ: 'touxType', condition: 'grasse' },
                    { champ: 'fievre', condition: true },
                    { champ: 'temp', condition: ['38', '38.5', '39'] },
                    { champ: 'fatigue', condition: true },
                    { champ: 'respiration', condition: true },
                    { champ: 'respiType', condition: 'sifflante' }
                ],
                absents: [
                    { champ: 'temp', condition: '40' },
                    { champ: 'respiType', condition: ['tirage', 'cyanose'] }
                ]
            },
            pneumonie: {
                nom: "Pneumonie",
                niveau: "orange",
                symptomes: [
                    { champ: 'fievre', condition: true },
                    { champ: 'temp', condition: ['39', '40'] },
                    { champ: 'toux', condition: true },
                    { champ: 'respiration', condition: true },
                    { champ: 'respiType', condition: 'rapide' },
                    { champ: 'fatigue', condition: true },
                    { champ: 'fatigueLevel', condition: 'marquee' },
                    { champ: 'frissons', condition: true }
                ],
                absents: []
            },
            grippe: {
                nom: "Grippe",
                niveau: "jaune",
                symptomes: [
                    { champ: 'fievre', condition: true },
                    { champ: 'temp', condition: ['39', '40'] },
                    { champ: 'frissons', condition: true },
                    { champ: 'courbatures', condition: true },
                    { champ: 'cephalee', condition: true },
                    { champ: 'fatigue', condition: true },
                    { champ: 'toux', condition: true },
                    { champ: 'touxType', condition: 'seche' },
                    { champ: 'gorge', condition: true }
                ],
                absents: [
                    { champ: 'douleurYeux', condition: true },
                    { champ: 'eruption', condition: true }
                ]
            },
            covid: {
                nom: "COVID-19",
                niveau: "jaune",
                symptomes: [
                    { champ: 'fievre', condition: true },
                    { champ: 'toux', condition: true },
                    { champ: 'fatigue', condition: true },
                    { champ: 'anosmie', condition: true },
                    { champ: 'cephalee', condition: true },
                    { champ: 'courbatures', condition: true },
                    { champ: 'gorge', condition: true },
                    { champ: 'diarrhee', condition: true }
                ],
                absents: [
                    { champ: 'douleurYeux', condition: true }
                ]
            },
            gastro: {
                nom: "Gastro-ent√©rite",
                niveau: "jaune",
                symptomes: [
                    { champ: 'vomissements', condition: true },
                    { champ: 'diarrhee', condition: true },
                    { champ: 'diarrheeType', condition: ['molle', 'liquide', 'explosive'] },
                    { champ: 'douleurAbdo', condition: true },
                    { champ: 'abdoCarac', condition: 'crampes' },
                    { champ: 'fievre', condition: true },
                    { champ: 'appetit', condition: true }
                ],
                absents: [
                    { champ: 'diarrheeCouleur', condition: ['sang', 'noire'] },
                    { champ: 'abdoLoc', condition: 'fid' },
                    { champ: 'vomiType', condition: ['sang', 'marc'] }
                ]
            },
            tiac: {
                nom: "Toxi-infection alimentaire (TIAC)",
                niveau: "orange",
                symptomes: [
                    { champ: 'vomissements', condition: true },
                    { champ: 'diarrhee', condition: true },
                    { champ: 'douleurAbdo', condition: true },
                    { champ: 'fievre', condition: true },
                    { champ: 'repasSuspect', condition: true },
                    { champ: 'collectivite', condition: true }
                ],
                absents: [
                    { champ: 'visionTrouble', condition: true },
                    { champ: 'faiblesseMusculaire', condition: true }
                ]
            },
            appendicite: {
                nom: "Appendicite",
                niveau: "orange",
                symptomes: [
                    { champ: 'douleurAbdo', condition: true },
                    { champ: 'abdoLoc', condition: ['nombril', 'fid'] },
                    { champ: 'abdoCarac', condition: 'migration' },
                    { champ: 'abdoCarac', condition: 'augmente' },
                    { champ: 'abdoAppend', condition: 'vomi-apres' },
                    { champ: 'abdoAppend', condition: 'anorexie' },
                    { champ: 'abdoAppend', condition: 'marche' },
                    { champ: 'abdoAppend', condition: 'couche' },
                    { champ: 'fievre', condition: true },
                    { champ: 'vomissements', condition: true }
                ],
                absents: [
                    { champ: 'diarrhee', condition: true },
                    { champ: 'diarrheeType', condition: 'explosive' }
                ]
            },
            occlusion: {
                nom: "Occlusion intestinale",
                niveau: "rouge",
                symptomes: [
                    { champ: 'douleurAbdo', condition: true },
                    { champ: 'abdoCarac', condition: 'constante' },
                    { champ: 'vomissements', condition: true },
                    { champ: 'vomiFreq', condition: 'incoercible' },
                    { champ: 'vomiType', condition: 'bilieux' },
                    { champ: 'constipation', condition: true }
                ],
                absents: [
                    { champ: 'diarrhee', condition: true }
                ]
            },
            hepatite: {
                nom: "H√©patite virale",
                niveau: "orange",
                symptomes: [
                    { champ: 'ictere', condition: true },
                    { champ: 'fatigue', condition: true },
                    { champ: 'appetit', condition: true },
                    { champ: 'vomissements', condition: true },
                    { champ: 'douleurAbdo', condition: true }
                ],
                absents: []
            },
            varicelle: {
                nom: "Varicelle",
                niveau: "vert",
                symptomes: [
                    { champ: 'eruption', condition: true },
                    { champ: 'eruptionType', condition: 'vesicules' },
                    { champ: 'eruptionGratte', condition: true },
                    { champ: 'eruptionLoc', condition: 'tronc' },
                    { champ: 'eruptionLoc', condition: 'visage' },
                    { champ: 'fievre', condition: true },
                    { champ: 'temp', condition: ['38', '38.5'] }
                ],
                absents: [
                    { champ: 'eruptionLoc', condition: 'mains' },
                    { champ: 'eruptionLoc', condition: 'pieds' },
                    { champ: 'aphtes', condition: true }
                ]
            },
            pmb: {
                nom: "Syndrome pieds-mains-bouche",
                niveau: "vert",
                symptomes: [
                    { champ: 'eruption', condition: true },
                    { champ: 'eruptionType', condition: 'vesicules' },
                    { champ: 'eruptionLoc', condition: 'mains' },
                    { champ: 'eruptionLoc', condition: 'pieds' },
                    { champ: 'aphtes', condition: true },
                    { champ: 'fievre', condition: true },
                    { champ: 'gorge', condition: true }
                ],
                absents: [
                    { champ: 'eruptionLoc', condition: 'tronc' }
                ]
            },
            urticaire: {
                nom: "Urticaire / Allergie",
                niveau: "jaune",
                symptomes: [
                    { champ: 'eruption', condition: true },
                    { champ: 'eruptionType', condition: 'urticaire' },
                    { champ: 'eruptionGratte', condition: true },
                    { champ: 'oedeme', condition: true }
                ],
                absents: [
                    { champ: 'respiType', condition: ['tirage', 'cyanose'] }
                ]
            },
            dengue: {
                nom: "Dengue",
                niveau: "orange",
                symptomes: [
                    { champ: 'fievre', condition: true },
                    { champ: 'temp', condition: ['39', '40'] },
                    { champ: 'douleurYeux', condition: true },
                    { champ: 'cephalee', condition: true },
                    { champ: 'cephaleeType', condition: 'intense' },
                    { champ: 'courbatures', condition: true },
                    { champ: 'fatigue', condition: true },
                    { champ: 'eruption', condition: true },
                    { champ: 'appetit', condition: true }
                ],
                absents: [
                    { champ: 'toux', condition: true },
                    { champ: 'touxType', condition: 'grasse' }
                ]
            },
            chikungunya: {
                nom: "Chikungunya",
                niveau: "jaune",
                symptomes: [
                    { champ: 'fievre', condition: true },
                    { champ: 'temp', condition: ['39', '40'] },
                    { champ: 'douleurArticulaire', condition: true },
                    { champ: 'articIntensite', condition: 'intense' },
                    { champ: 'articLoc', condition: 'multiples' },
                    { champ: 'eruption', condition: true },
                    { champ: 'cephalee', condition: true },
                    { champ: 'courbatures', condition: true }
                ],
                absents: [
                    { champ: 'douleurYeux', condition: true }
                ]
            },
            leptospirose: {
                nom: "Leptospirose",
                niveau: "orange",
                symptomes: [
                    { champ: 'fievre', condition: true },
                    { champ: 'cephalee', condition: true },
                    { champ: 'cephaleeType', condition: 'intense' },
                    { champ: 'courbatures', condition: true },
                    { champ: 'baignade', condition: true },
                    { champ: 'ictere', condition: true },
                    { champ: 'yeux', condition: true },
                    { champ: 'yeuxTypes', condition: 'rouge' }
                ],
                absents: []
            },
            mononucleose: {
                nom: "Mononucl√©ose infectieuse",
                niveau: "jaune",
                symptomes: [
                    { champ: 'fatigue', condition: true },
                    { champ: 'fatigueLevel', condition: 'marquee' },
                    { champ: 'ganglions', condition: true },
                    { champ: 'ganglionsLoc', condition: 'multiple' },
                    { champ: 'gorge', condition: true },
                    { champ: 'fievre', condition: true },
                    { champ: 'appetit', condition: true }
                ],
                absents: []
            },
            cystite: {
                nom: "Cystite (infection urinaire basse)",
                niveau: "jaune",
                symptomes: [
                    { champ: 'urinaire', condition: true },
                    { champ: 'uriSignes', condition: 'brulure' },
                    { champ: 'uriSignes', condition: 'frequent' },
                    { champ: 'uriSignes', condition: 'trouble' },
                    { champ: 'uriSignes', condition: 'odeur' }
                ],
                absents: [
                    { champ: 'fievre', condition: true },
                    { champ: 'douleurLombaire', condition: true }
                ]
            },
            pyelonephrite: {
                nom: "Py√©lon√©phrite",
                niveau: "orange",
                symptomes: [
                    { champ: 'fievre', condition: true },
                    { champ: 'temp', condition: ['39', '40'] },
                    { champ: 'douleurLombaire', condition: true },
                    { champ: 'frissons', condition: true },
                    { champ: 'urinaire', condition: true },
                    { champ: 'uriSignes', condition: 'brulure' },
                    { champ: 'vomissements', condition: true }
                ],
                absents: []
            },
            herpangine: {
                nom: "Herpangine",
                niveau: "jaune",
                symptomes: [
                    { champ: 'aphtes', condition: true },
                    { champ: 'fievre', condition: true },
                    { champ: 'temp', condition: ['39', '40'] },
                    { champ: 'gorge', condition: true },
                    { champ: 'gorgeType', condition: 'avaler' },
                    { champ: 'appetit', condition: true }
                ],
                absents: [
                    { champ: 'eruption', condition: true },
                    { champ: 'eruptionLoc', condition: 'mains' }
                ]
            },
            conjonctivite: {
                nom: "Conjonctivite",
                niveau: "vert",
                symptomes: [
                    { champ: 'yeux', condition: true },
                    { champ: 'yeuxTypes', condition: 'rouge' },
                    { champ: 'yeuxTypes', condition: 'colles' },
                    { champ: 'yeuxTypes', condition: 'larmoie' }
                ],
                absents: [
                    { champ: 'photophobie', condition: true }
                ]
            },
            meningite: {
                nom: "M√©ningite",
                niveau: "rouge",
                symptomes: [
                    { champ: 'fievre', condition: true },
                    { champ: 'temp', condition: ['39', '40'] },
                    { champ: 'cephalee', condition: true },
                    { champ: 'cephaleeType', condition: 'intense' },
                    { champ: 'raideurNuque', condition: true },
                    { champ: 'photophobie', condition: true },
                    { champ: 'vomissements', condition: true },
                    { champ: 'confusion', condition: true },
                    { champ: 'eruptionType', condition: 'purpura' }
                ],
                absents: []
            },
            botulisme: {
                nom: "Botulisme",
                niveau: "rouge",
                symptomes: [
                    { champ: 'visionTrouble', condition: true },
                    { champ: 'paupieresTombantes', condition: true },
                    { champ: 'difficulteParler', condition: true },
                    { champ: 'gorgeType', condition: 'avaler' },
                    { champ: 'faiblesseMusculaire', condition: true },
                    { champ: 'constipation', condition: true },
                    { champ: 'conserveMaison', condition: true }
                ],
                absents: [
                    { champ: 'fievre', condition: true }
                ]
            },
            arthrite_septique: {
                nom: "Arthrite septique",
                niveau: "orange",
                symptomes: [
                    { champ: 'douleurMembre', condition: true },
                    { champ: 'membreSignes', condition: 'gonfle' },
                    { champ: 'membreSignes', condition: 'rouge' },
                    { champ: 'fievre', condition: true },
                    { champ: 'membreSignes', condition: 'boiterie' }
                ],
                absents: []
            },
            anaphylaxie: {
                nom: "R√©action anaphylactique",
                niveau: "rouge",
                symptomes: [
                    { champ: 'eruption', condition: true },
                    { champ: 'eruptionType', condition: 'urticaire' },
                    { champ: 'oedeme', condition: true },
                    { champ: 'oedemeLoc', condition: ['visage', 'levres'] },
                    { champ: 'respiration', condition: true },
                    { champ: 'respiType', condition: ['tirage', 'sifflante'] },
                    { champ: 'vertiges', condition: true },
                    { champ: 'vomissements', condition: true },
                    { champ: 'paleurType', condition: ['pale', 'marbrures'] }
                ],
                absents: []
            }
        };

        // Fonction pour v√©rifier si une condition est remplie
        function checkCondition(data, champ, condition) {
            const valeur = data[champ];
            
            // Champ non renseign√©
            if (valeur === undefined || valeur === null || valeur === false || valeur === '') {
                return false;
            }
            
            // Condition bool√©enne simple (juste v√©rifier que c'est coch√©)
            if (condition === true) {
                return valeur === true || (Array.isArray(valeur) && valeur.length > 0) || (typeof valeur === 'string' && valeur !== '');
            }
            
            // Condition sur une valeur sp√©cifique
            if (typeof condition === 'string') {
                if (Array.isArray(valeur)) {
                    return valeur.includes(condition);
                }
                return valeur === condition;
            }
            
            // Condition sur plusieurs valeurs possibles
            if (Array.isArray(condition)) {
                if (Array.isArray(valeur)) {
                    return condition.some(c => valeur.includes(c));
                }
                return condition.includes(valeur);
            }
            
            return false;
        }

        // Fonction de calcul des scores
        function calculerScores(data) {
            const resultats = [];
            
            for (const [key, maladie] of Object.entries(maladiesScoring)) {
                let matchs = 0;
                let totalSymptomes = maladie.symptomes.length;
                let malus = 0;
                const symptomesMatches = [];
                const symptomesAbsentsPresents = [];
                
                // Compter les sympt√¥mes qui matchent
                for (const symptome of maladie.symptomes) {
                    if (checkCondition(data, symptome.champ, symptome.condition)) {
                        matchs++;
                        symptomesMatches.push(symptome.champ);
                    }
                }
                
                // V√©rifier les sympt√¥mes qui devraient √™tre absents
                for (const absent of maladie.absents) {
                    if (checkCondition(data, absent.champ, absent.condition)) {
                        malus += 15; // -15% par sympt√¥me "absent" pr√©sent
                        symptomesAbsentsPresents.push(absent.champ);
                    }
                }
                
                // Calculer le score
                let score = (matchs / totalSymptomes) * 100;
                score = Math.max(0, score - malus); // Appliquer le malus
                
                // Ne garder que si au moins 2 sympt√¥mes matchent ET score > 25%
                if (matchs >= 2 && score > 25) {
                    resultats.push({
                        key: key,
                        nom: maladie.nom,
                        niveau: maladie.niveau,
                        score: Math.round(score),
                        matchs: matchs,
                        total: totalSymptomes,
                        symptomesMatches: symptomesMatches,
                        symptomesAbsentsPresents: symptomesAbsentsPresents
                    });
                }
            }
            
            // Trier par score d√©croissant
            resultats.sort((a, b) => b.score - a.score);
            
            return resultats;
        }

        // ========== AFFICHAGE MALADIE ==========
        function afficherMaladie() {
            const select = document.getElementById('maladie-select');
            const detailDiv = document.getElementById('maladie-detail');
            const maladieKey = select.value;
            
            if (!maladieKey) {
                detailDiv.innerHTML = '';
                return;
            }
            
            const m = maladiesDB[maladieKey];
            if (!m) return;
            
            const niveauLabels = {
                vert: 'üü¢ Surveillance √† domicile',
                jaune: 'üü° Consultation sous 24-48h',
                orange: 'üü† Consultation dans la journ√©e',
                rouge: 'üî¥ URGENCE - Appeler le 15'
            };
            
            let html = '<div class="maladie-detail">';
            html += `<h3>${m.nom}</h3>`;
            html += `<p>${m.description}</p>`;
            html += `<span class="section-niveau niveau-${m.niveau}">${niveauLabels[m.niveau]}</span>`;
            
            // Sympt√¥mes typiques
            if (m.symptomes.length > 0) {
                html += '<div class="maladie-section section-symptomes">';
                html += '<h4>‚úÖ Sympt√¥mes typiques</h4><ul>';
                m.symptomes.forEach(s => html += `<li>${s}</li>`);
                html += '</ul></div>';
            }
            
            // Sympt√¥mes absents
            if (m.absents.length > 0) {
                html += '<div class="maladie-section section-absents">';
                html += '<h4>‚ùå Sympt√¥mes habituellement absents</h4><ul>';
                m.absents.forEach(s => html += `<li>${s}</li>`);
                html += '</ul></div>';
            }
            
            // Signes d'alerte
            if (m.alertes.length > 0) {
                html += '<div class="maladie-section section-alertes">';
                html += '<h4>‚ö†Ô∏è Signes d\'alerte (reconsulter si)</h4><ul>';
                m.alertes.forEach(s => html += `<li>${s}</li>`);
                html += '</ul></div>';
            }
            
            // Conseils
            if (m.conseils.length > 0) {
                html += '<div class="maladie-section section-conseils">';
                html += '<h4>üí° Conseils</h4><ul>';
                m.conseils.forEach(s => html += `<li>${s}</li>`);
                html += '</ul></div>';
            }
            
            // √Ä ne pas faire
            if (m.nonFaire && m.nonFaire.length > 0) {
                html += '<div class="maladie-section section-alertes">';
                html += '<h4>üö´ √Ä ne PAS faire</h4><ul>';
                m.nonFaire.forEach(s => html += `<li>${s}</li>`);
                html += '</ul></div>';
            }
            
            html += '</div>';
            detailDiv.innerHTML = html;
        }
    </script>
</body>
</html>
